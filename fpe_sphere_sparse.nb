(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    120602,       3063]
NotebookOptionsPosition[    118397,       2987]
NotebookOutlinePosition[    118765,       3003]
CellTagsIndexPosition[    118722,       3000]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Assemble sparse matrices from the matrix elements\
\>", "Title",
 CellChangeTimes->{{3.5792723741939163`*^9, 3.579272381921358*^9}}],

Cell["\<\
Two different types of matrices are assembled:
1. The full matrix, all l,m included. This is used for time-dependent \
solutions.
2. The augmented matrix, only even l,m (due to symmetries in the Jeffery \
equations), and the l=0 mode removed and moved to the right hand side, such \
that the matrix equation is actually invertible.\
\>", "Subsubtitle",
 CellChangeTimes->{{3.5792725236964674`*^9, 3.579272612112524*^9}}],

Cell["\<\
NOTE: The optimizations in here are true not in general.
Even l,m : Due to symmetries in the Jeffery problem in shear flow
Conjugate matrixelementns upon \[CapitalDelta]m->-\[CapitalDelta]m because P \
is real-valued\
\>", "Text",
 CellChangeTimes->{{3.5792729193900995`*^9, 3.579273009413248*^9}, {
  3.5792730593971076`*^9, 3.579273071564803*^9}}],

Cell[CellGroupData[{

Cell["\<\
Matrix elements (taken from previous notebook)\
\>", "Section",
 CellChangeTimes->{{3.5792726197129593`*^9, 3.5792726295995245`*^9}}],

Cell["\<\
These are the matrix elements from the previous file, just copied and pasted.\
\>", "Text",
 CellChangeTimes->{{3.5792724791689205`*^9, 3.579272492696694*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"matrixelements", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "2"}], ",", "0"}], "}"}], ",", 
      TagBox[GridBox[{
         {"\[Piecewise]", GridBox[{
            {"0", 
             RowBox[{
              RowBox[{"l", "<", "2"}], "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"l", "\[GreaterEqual]", 
                   RowBox[{"2", "+", "m"}]}], "||", 
                  RowBox[{
                   RowBox[{"l", "+", "m"}], "\[LessEqual]", "1"}]}], ")"}], "&&", 
                RowBox[{"m", "\[GreaterEqual]", "0"}]}], ")"}], "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"m", "<", "0"}], "&&", 
                RowBox[{
                 RowBox[{"l", "+", "m"}], "\[GreaterEqual]", "2"}]}], ")"}]}]},
            {
             RowBox[{
              FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", "m", " ", 
              SqrtBox[
               FractionBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "l", "-", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"l", "-", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "l", "+", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"l", "+", "m"}], ")"}]}], 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{"2", " ", "l"}]}], ")"}], "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "l"}], ")"}], "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "3"}], "+", 
                   RowBox[{"2", " ", "l"}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"2", " ", "l"}]}], ")"}]}]]]}], 
             RowBox[{
              RowBox[{"l", ">", 
               RowBox[{"1", "+", "m"}]}], "&&", 
              RowBox[{
               RowBox[{"l", "+", "m"}], ">", "1"}]}]},
            {
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", "l", "-", "m"}], ")"}], " ", 
               SqrtBox[
                FractionBox[
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "l", "-", "m"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"l", "-", "m"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "l", "+", "m"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"l", "+", "m"}], ")"}]}], 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{"2", " ", "l"}]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"2", " ", "l"}]}], ")"}]}]]]}], 
              RowBox[{
               RowBox[{"-", "4"}], "+", 
               RowBox[{"8", " ", "l"}]}]], 
             RowBox[{
              RowBox[{"l", "\[GreaterEqual]", "2"}], "&&", 
              RowBox[{
               RowBox[{"l", "+", "m"}], ">", "1"}]}]},
            {
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", "l", "+", "m"}], ")"}], " ", 
               SqrtBox[
                RowBox[{"-", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "l", "-", "m"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"l", "-", "m"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "l", "+", "m"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"l", "+", "m"}], ")"}]}], 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{"2", " ", "l"}]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"2", " ", "l"}]}], ")"}]}]]}]]}], 
              RowBox[{
               RowBox[{"-", "4"}], "+", 
               RowBox[{"8", " ", "l"}]}]], 
             TagBox["True",
              "PiecewiseDefault",
              AutoDelete->True]}
           },
           AllowedDimensions->{2, Automatic},
           Editable->True,
           
           GridBoxAlignment->{
            "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{1.}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.84]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}},
           Selectable->True]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.35]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       "Piecewise",
       DeleteWithContents->True,
       Editable->False,
       SelectWithContents->True,
       Selectable->False]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
      TagBox[GridBox[{
         {"\[Piecewise]", GridBox[{
            {
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", "l"}], ")"}], " ", 
               SqrtBox[
                FractionBox[
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "3"}], "+", "l", "-", "m"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "2"}], "+", "l", "-", "m"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "l", "-", "m"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"l", "-", "m"}], ")"}]}], 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{"2", " ", "l"}]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"2", " ", "l"}]}], ")"}]}]]], " ", 
               "\[CapitalLambda]"}], 
              RowBox[{
               RowBox[{"-", "4"}], "+", 
               RowBox[{"8", " ", "l"}]}]], 
             RowBox[{
              RowBox[{"l", "\[GreaterEqual]", "2"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"l", "\[GreaterEqual]", 
                 RowBox[{"4", "+", "m"}]}], "||", 
                RowBox[{"m", "<", 
                 RowBox[{"-", "2"}]}]}], ")"}]}]},
            {
             RowBox[{
              FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", 
              SqrtBox[
               FractionBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "3"}], "+", "l", "-", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "2"}], "+", "l", "-", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "l", "-", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"l", "-", "m"}], ")"}], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"l", "+", "m"}], ")"}], "2"]}], 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{"2", " ", "l"}]}], ")"}], "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "l"}], ")"}], "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "3"}], "+", 
                   RowBox[{"2", " ", "l"}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"2", " ", "l"}]}], ")"}]}]]], " ", 
              "\[CapitalLambda]"}], 
             RowBox[{"l", ">", 
              RowBox[{"3", "+", "m"}]}]},
            {"0", 
             TagBox["True",
              "PiecewiseDefault",
              AutoDelete->True]}
           },
           AllowedDimensions->{2, Automatic},
           Editable->True,
           
           GridBoxAlignment->{
            "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{1.}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.84]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}},
           Selectable->True]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.35]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       "Piecewise",
       DeleteWithContents->True,
       Editable->False,
       SelectWithContents->True,
       Selectable->False]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      TagBox[GridBox[{
         {"\[Piecewise]", GridBox[{
            {
             RowBox[{
              RowBox[{
               RowBox[{"-", "invPe"}], " ", "l", " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", "l"}], ")"}]}], "+", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "m"}], "3"]}], 
             RowBox[{"l", "<", "1"}]},
            {
             RowBox[{
              RowBox[{
               RowBox[{"-", "invPe"}], " ", "l", " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", "l"}], ")"}]}], "+", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "m"}], "2"]}], 
             TagBox["True",
              "PiecewiseDefault",
              AutoDelete->True]}
           },
           AllowedDimensions->{2, Automatic},
           Editable->True,
           
           GridBoxAlignment->{
            "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{1.}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.84]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}},
           Selectable->True]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.35]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       "Piecewise",
       DeleteWithContents->True,
       Editable->False,
       SelectWithContents->True,
       Selectable->False]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "2"}], "}"}], ",", 
      TagBox[GridBox[{
         {"\[Piecewise]", GridBox[{
            {
             RowBox[{
              FractionBox["3", "4"], " ", "\[ImaginaryI]", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", "l"}], ")"}], " ", 
              SqrtBox[
               FractionBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "l", "-", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"l", "-", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", "l", "+", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"2", "+", "l", "+", "m"}], ")"}]}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "3"}], "+", 
                   RowBox[{"l", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"4", " ", "l", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", "l"}], ")"}]}]}], ")"}]}]}], ")"}], 
                 "2"]]], " ", "\[CapitalLambda]"}], 
             RowBox[{
              RowBox[{"l", "\[GreaterEqual]", "1"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"l", "\[GreaterEqual]", 
                 RowBox[{"2", "+", "m"}]}], "||", 
                RowBox[{"m", "<", 
                 RowBox[{"-", "2"}]}]}], ")"}]}]},
            {
             RowBox[{
              RowBox[{"-", 
               FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", "l"}], ")"}], " ", 
              SqrtBox[
               FractionBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "l", "-", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"l", "-", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", "l", "+", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"2", "+", "l", "+", "m"}], ")"}]}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "3"}], "+", 
                   RowBox[{"l", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"4", " ", "l", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", "l"}], ")"}]}]}], ")"}]}]}], ")"}], 
                 "2"]]], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"2", " ", "m"}]}], ")"}], " ", "\[CapitalLambda]"}], 
             RowBox[{"l", ">", 
              RowBox[{"1", "+", "m"}]}]},
            {"0", 
             TagBox["True",
              "PiecewiseDefault",
              AutoDelete->True]}
           },
           AllowedDimensions->{2, Automatic},
           Editable->True,
           
           GridBoxAlignment->{
            "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{1.}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.84]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}},
           Selectable->True]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.35]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       "Piecewise",
       DeleteWithContents->True,
       Editable->False,
       SelectWithContents->True,
       Selectable->False]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}], ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"3", "+", "l"}], ")"}], " ", 
         SqrtBox[
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", "l", "+", "m"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", "l", "+", "m"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"3", "+", "l", "+", "m"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"4", "+", "l", "+", "m"}], ")"}]}], 
           RowBox[{"5", "+", 
            RowBox[{"12", " ", "l"}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["l", "2"]}]}]]], " ", "\[CapitalLambda]"}], 
        RowBox[{"12", "+", 
         RowBox[{"8", " ", "l"}]}]]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "2"}], ",", 
        RowBox[{"-", "2"}]}], "}"}], ",", 
      RowBox[{"Conjugate", "[", 
       TagBox[GridBox[{
          {"\[Piecewise]", GridBox[{
             {
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "l"}], ")"}], " ", 
                SqrtBox[
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "3"}], "+", "l", "+", "m"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "l", "+", "m"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "l", "+", "m"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"l", "+", "m"}], ")"}]}], 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{"2", " ", "l"}]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"2", " ", "l"}]}], ")"}]}]]], " ", 
                "\[CapitalLambda]"}], 
               RowBox[{
                RowBox[{"-", "4"}], "+", 
                RowBox[{"8", " ", "l"}]}]], 
              RowBox[{
               RowBox[{"l", "\[GreaterEqual]", "2"}], "&&", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"l", "+", "m"}], "\[GreaterEqual]", "4"}], "||", 
                 RowBox[{"m", ">", "2"}]}], ")"}]}]},
             {
              RowBox[{
               FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", 
               SqrtBox[
                FractionBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"l", "-", "m"}], ")"}], "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "3"}], "+", "l", "+", "m"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "2"}], "+", "l", "+", "m"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "l", "+", "m"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"l", "+", "m"}], ")"}]}], 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"2", " ", "l"}]}], ")"}], "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "l"}], ")"}], "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{"2", " ", "l"}]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"2", " ", "l"}]}], ")"}]}]]], " ", 
               "\[CapitalLambda]"}], 
              RowBox[{
               RowBox[{"l", "+", "m"}], ">", "3"}]},
             {"0", 
              TagBox["True",
               "PiecewiseDefault",
               AutoDelete->True]}
            },
            AllowedDimensions->{2, Automatic},
            Editable->True,
            
            GridBoxAlignment->{
             "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{1.}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.84]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}},
            Selectable->True]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.35]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        "Piecewise",
        DeleteWithContents->True,
        Editable->False,
        SelectWithContents->True,
        Selectable->False], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "2"}]}], "}"}], ",", 
      RowBox[{"Conjugate", "[", 
       TagBox[GridBox[{
          {"\[Piecewise]", GridBox[{
             {
              RowBox[{
               FractionBox["3", "4"], " ", "\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", "l"}], ")"}], " ", 
               SqrtBox[
                FractionBox[
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "+", "l", "-", "m"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"2", "+", "l", "-", "m"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "l", "+", "m"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"l", "+", "m"}], ")"}]}], 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{"l", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"4", " ", "l", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", "l"}], ")"}]}]}], ")"}]}]}], ")"}], 
                  "2"]]], " ", "\[CapitalLambda]"}], 
              RowBox[{
               RowBox[{"l", "\[GreaterEqual]", "1"}], "&&", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"l", "+", "m"}], "\[GreaterEqual]", "2"}], "||", 
                 RowBox[{"m", ">", "2"}]}], ")"}]}]},
             {
              RowBox[{
               FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", "l"}], ")"}], " ", 
               SqrtBox[
                FractionBox[
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "+", "l", "-", "m"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"2", "+", "l", "-", "m"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "l", "+", "m"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"l", "+", "m"}], ")"}]}], 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{"l", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"4", " ", "l", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", "l"}], ")"}]}]}], ")"}]}]}], ")"}], 
                  "2"]]], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"2", " ", "m"}]}], ")"}], " ", "\[CapitalLambda]"}], 
              RowBox[{
               RowBox[{"l", "+", "m"}], ">", "1"}]},
             {"0", 
              TagBox["True",
               "PiecewiseDefault",
               AutoDelete->True]}
            },
            AllowedDimensions->{2, Automatic},
            Editable->True,
            
            GridBoxAlignment->{
             "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{1.}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.84]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}},
            Selectable->True]}
         },
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.35]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        "Piecewise",
        DeleteWithContents->True,
        Editable->False,
        SelectWithContents->True,
        Selectable->False], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "2"}]}], "}"}], ",", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", "l"}], ")"}], " ", 
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "l", "-", "m"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", "l", "-", "m"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", "l", "-", "m"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"4", "+", "l", "-", "m"}], ")"}]}], 
          RowBox[{"5", "+", 
           RowBox[{"12", " ", "l"}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["l", "2"]}]}]]], " ", "\[CapitalLambda]"}], 
       RowBox[{"12", "+", 
        RowBox[{"8", " ", "l"}]}]]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.579272469789384*^9, 3.5792724751236887`*^9}, 
   3.5792752845133767`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", "0"}], "}"}], ",", 
     TagBox[GridBox[{
        {"\[Piecewise]", GridBox[{
           {"0", 
            RowBox[{
             RowBox[{"l", "<", "2"}], "||", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"l", "\[GreaterEqual]", 
                  RowBox[{"2", "+", "m"}]}], "||", 
                 RowBox[{
                  RowBox[{"l", "+", "m"}], "\[LessEqual]", "1"}]}], ")"}], "&&", 
               RowBox[{"m", "\[GreaterEqual]", "0"}]}], ")"}], "||", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", "<", "0"}], "&&", 
               RowBox[{
                RowBox[{"l", "+", "m"}], "\[GreaterEqual]", "2"}]}], ")"}]}]},
           {
            RowBox[{
             FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", "m", " ", 
             SqrtBox[
              FractionBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "l", "-", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"l", "-", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "l", "+", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"l", "+", "m"}], ")"}]}], 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"2", " ", "l"}]}], ")"}], "2"], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "l"}], ")"}], "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", 
                  RowBox[{"2", " ", "l"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"2", " ", "l"}]}], ")"}]}]]]}], 
            RowBox[{
             RowBox[{"l", ">", 
              RowBox[{"1", "+", "m"}]}], "&&", 
             RowBox[{
              RowBox[{"l", "+", "m"}], ">", "1"}]}]},
           {
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", "l", "-", "m"}], ")"}], " ", 
              SqrtBox[
               FractionBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "l", "-", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"l", "-", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "l", "+", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"l", "+", "m"}], ")"}]}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "3"}], "+", 
                   RowBox[{"2", " ", "l"}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"2", " ", "l"}]}], ")"}]}]]]}], 
             RowBox[{
              RowBox[{"-", "4"}], "+", 
              RowBox[{"8", " ", "l"}]}]], 
            RowBox[{
             RowBox[{"l", "\[GreaterEqual]", "2"}], "&&", 
             RowBox[{
              RowBox[{"l", "+", "m"}], ">", "1"}]}]},
           {
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", "l", "+", "m"}], ")"}], " ", 
              SqrtBox[
               RowBox[{"-", 
                FractionBox[
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "l", "-", "m"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"l", "-", "m"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "l", "+", "m"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"l", "+", "m"}], ")"}]}], 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{"2", " ", "l"}]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"2", " ", "l"}]}], ")"}]}]]}]]}], 
             RowBox[{
              RowBox[{"-", "4"}], "+", 
              RowBox[{"8", " ", "l"}]}]], 
            TagBox["True",
             "PiecewiseDefault",
             AutoDelete->True]}
          },
          AllowedDimensions->{2, Automatic},
          Editable->True,
          
          GridBoxAlignment->{
           "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{1.}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.84]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}},
          Selectable->True]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.35]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      "Piecewise",
      DeleteWithContents->True,
      Editable->False,
      SelectWithContents->True,
      Selectable->False]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
     TagBox[GridBox[{
        {"\[Piecewise]", GridBox[{
           {
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", "l"}], ")"}], " ", 
              SqrtBox[
               FractionBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "3"}], "+", "l", "-", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "2"}], "+", "l", "-", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "l", "-", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"l", "-", "m"}], ")"}]}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "3"}], "+", 
                   RowBox[{"2", " ", "l"}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"2", " ", "l"}]}], ")"}]}]]], " ", 
              "\[CapitalLambda]"}], 
             RowBox[{
              RowBox[{"-", "4"}], "+", 
              RowBox[{"8", " ", "l"}]}]], 
            RowBox[{
             RowBox[{"l", "\[GreaterEqual]", "2"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"l", "\[GreaterEqual]", 
                RowBox[{"4", "+", "m"}]}], "||", 
               RowBox[{"m", "<", 
                RowBox[{"-", "2"}]}]}], ")"}]}]},
           {
            RowBox[{
             FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", 
             SqrtBox[
              FractionBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", "l", "-", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "l", "-", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "l", "-", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"l", "-", "m"}], ")"}], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"l", "+", "m"}], ")"}], "2"]}], 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"2", " ", "l"}]}], ")"}], "2"], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "l"}], ")"}], "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", 
                  RowBox[{"2", " ", "l"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"2", " ", "l"}]}], ")"}]}]]], " ", 
             "\[CapitalLambda]"}], 
            RowBox[{"l", ">", 
             RowBox[{"3", "+", "m"}]}]},
           {"0", 
            TagBox["True",
             "PiecewiseDefault",
             AutoDelete->True]}
          },
          AllowedDimensions->{2, Automatic},
          Editable->True,
          
          GridBoxAlignment->{
           "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{1.}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.84]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}},
          Selectable->True]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.35]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      "Piecewise",
      DeleteWithContents->True,
      Editable->False,
      SelectWithContents->True,
      Selectable->False]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     TagBox[GridBox[{
        {"\[Piecewise]", GridBox[{
           {
            RowBox[{
             RowBox[{
              RowBox[{"-", "invPe"}], " ", "l", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", "l"}], ")"}]}], "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "m"}], "3"]}], 
            RowBox[{"l", "<", "1"}]},
           {
            RowBox[{
             RowBox[{
              RowBox[{"-", "invPe"}], " ", "l", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", "l"}], ")"}]}], "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "m"}], "2"]}], 
            TagBox["True",
             "PiecewiseDefault",
             AutoDelete->True]}
          },
          AllowedDimensions->{2, Automatic},
          Editable->True,
          
          GridBoxAlignment->{
           "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{1.}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.84]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}},
          Selectable->True]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.35]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      "Piecewise",
      DeleteWithContents->True,
      Editable->False,
      SelectWithContents->True,
      Selectable->False]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "2"}], "}"}], ",", 
     TagBox[GridBox[{
        {"\[Piecewise]", GridBox[{
           {
            RowBox[{
             FractionBox["3", "4"], " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "l"}], ")"}], " ", 
             SqrtBox[
              FractionBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "l", "-", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"l", "-", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "l", "+", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"2", "+", "l", "+", "m"}], ")"}]}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", 
                  RowBox[{"l", " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"4", " ", "l", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", "l"}], ")"}]}]}], ")"}]}]}], ")"}], 
                "2"]]], " ", "\[CapitalLambda]"}], 
            RowBox[{
             RowBox[{"l", "\[GreaterEqual]", "1"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"l", "\[GreaterEqual]", 
                RowBox[{"2", "+", "m"}]}], "||", 
               RowBox[{"m", "<", 
                RowBox[{"-", "2"}]}]}], ")"}]}]},
           {
            RowBox[{
             RowBox[{"-", 
              FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "l"}], ")"}], " ", 
             SqrtBox[
              FractionBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "l", "-", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"l", "-", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "l", "+", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"2", "+", "l", "+", "m"}], ")"}]}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", 
                  RowBox[{"l", " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"4", " ", "l", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", "l"}], ")"}]}]}], ")"}]}]}], ")"}], 
                "2"]]], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"2", " ", "m"}]}], ")"}], " ", "\[CapitalLambda]"}], 
            RowBox[{"l", ">", 
             RowBox[{"1", "+", "m"}]}]},
           {"0", 
            TagBox["True",
             "PiecewiseDefault",
             AutoDelete->True]}
          },
          AllowedDimensions->{2, Automatic},
          Editable->True,
          
          GridBoxAlignment->{
           "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{1.}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.84]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}},
          Selectable->True]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.35]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      "Piecewise",
      DeleteWithContents->True,
      Editable->False,
      SelectWithContents->True,
      Selectable->False]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", "l"}], ")"}], " ", 
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "l", "+", "m"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", "l", "+", "m"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", "l", "+", "m"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"4", "+", "l", "+", "m"}], ")"}]}], 
          RowBox[{"5", "+", 
           RowBox[{"12", " ", "l"}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["l", "2"]}]}]]], " ", "\[CapitalLambda]"}], 
       RowBox[{"12", "+", 
        RowBox[{"8", " ", "l"}]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", 
       RowBox[{"-", "2"}]}], "}"}], ",", 
     RowBox[{"Conjugate", "[", 
      TagBox[GridBox[{
         {"\[Piecewise]", GridBox[{
            {
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", "l"}], ")"}], " ", 
               SqrtBox[
                FractionBox[
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "3"}], "+", "l", "+", "m"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "2"}], "+", "l", "+", "m"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "l", "+", "m"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"l", "+", "m"}], ")"}]}], 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{"2", " ", "l"}]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"2", " ", "l"}]}], ")"}]}]]], " ", 
               "\[CapitalLambda]"}], 
              RowBox[{
               RowBox[{"-", "4"}], "+", 
               RowBox[{"8", " ", "l"}]}]], 
             RowBox[{
              RowBox[{"l", "\[GreaterEqual]", "2"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"l", "+", "m"}], "\[GreaterEqual]", "4"}], "||", 
                RowBox[{"m", ">", "2"}]}], ")"}]}]},
            {
             RowBox[{
              FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", 
              SqrtBox[
               FractionBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"l", "-", "m"}], ")"}], "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "3"}], "+", "l", "+", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "2"}], "+", "l", "+", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "l", "+", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"l", "+", "m"}], ")"}]}], 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{"2", " ", "l"}]}], ")"}], "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "l"}], ")"}], "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "3"}], "+", 
                   RowBox[{"2", " ", "l"}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"2", " ", "l"}]}], ")"}]}]]], " ", 
              "\[CapitalLambda]"}], 
             RowBox[{
              RowBox[{"l", "+", "m"}], ">", "3"}]},
            {"0", 
             TagBox["True",
              "PiecewiseDefault",
              AutoDelete->True]}
           },
           AllowedDimensions->{2, Automatic},
           Editable->True,
           
           GridBoxAlignment->{
            "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{1.}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.84]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}},
           Selectable->True]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.35]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       "Piecewise",
       DeleteWithContents->True,
       Editable->False,
       SelectWithContents->True,
       Selectable->False], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "2"}]}], "}"}], ",", 
     RowBox[{"Conjugate", "[", 
      TagBox[GridBox[{
         {"\[Piecewise]", GridBox[{
            {
             RowBox[{
              FractionBox["3", "4"], " ", "\[ImaginaryI]", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", "l"}], ")"}], " ", 
              SqrtBox[
               FractionBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "+", "l", "-", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"2", "+", "l", "-", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "l", "+", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"l", "+", "m"}], ")"}]}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "3"}], "+", 
                   RowBox[{"l", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"4", " ", "l", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", "l"}], ")"}]}]}], ")"}]}]}], ")"}], 
                 "2"]]], " ", "\[CapitalLambda]"}], 
             RowBox[{
              RowBox[{"l", "\[GreaterEqual]", "1"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"l", "+", "m"}], "\[GreaterEqual]", "2"}], "||", 
                RowBox[{"m", ">", "2"}]}], ")"}]}]},
            {
             RowBox[{
              FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", "l"}], ")"}], " ", 
              SqrtBox[
               FractionBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "+", "l", "-", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"2", "+", "l", "-", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "l", "+", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"l", "+", "m"}], ")"}]}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "3"}], "+", 
                   RowBox[{"l", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"4", " ", "l", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", "l"}], ")"}]}]}], ")"}]}]}], ")"}], 
                 "2"]]], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"2", " ", "m"}]}], ")"}], " ", "\[CapitalLambda]"}], 
             RowBox[{
              RowBox[{"l", "+", "m"}], ">", "1"}]},
            {"0", 
             TagBox["True",
              "PiecewiseDefault",
              AutoDelete->True]}
           },
           AllowedDimensions->{2, Automatic},
           Editable->True,
           
           GridBoxAlignment->{
            "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{1.}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.84]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}},
           Selectable->True]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.35]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       "Piecewise",
       DeleteWithContents->True,
       Editable->False,
       SelectWithContents->True,
       Selectable->False], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "2"}]}], "}"}], ",", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"(", 
        RowBox[{"3", "+", "l"}], ")"}], " ", 
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "l", "-", "m"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", "l", "-", "m"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"3", "+", "l", "-", "m"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"4", "+", "l", "-", "m"}], ")"}]}], 
         RowBox[{"5", "+", 
          RowBox[{"12", " ", "l"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["l", "2"]}]}]]], " ", "\[CapitalLambda]"}], 
      RowBox[{"12", "+", 
       RowBox[{"8", " ", "l"}]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.579275285341424*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Complete matrix, all modes", "Section",
 CellChangeTimes->{{3.5792726367839355`*^9, 3.5792726492316475`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"assemblesparse", "[", "maxl_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "row", ",", "p", ",", "q", ",", "col", ",", "dl", ",", "dm", ",", "l2", 
       ",", "m2", ",", "sparserules", ",", "value", ",", "size", ",", "k", 
       ",", "delta"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"size", " ", "=", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"2", " ", "l"}], "+", "1"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", "0", ",", "maxl"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "size", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"row", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"sparserules", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"p", "=", "0"}], ",", 
        RowBox[{"p", "<=", "maxl"}], ",", 
        RowBox[{"p", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"q", "=", 
           RowBox[{"-", "p"}]}], ",", 
          RowBox[{"q", "\[LessEqual]", "p"}], ",", 
          RowBox[{"q", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"k", "=", "1"}], ",", 
              RowBox[{"k", "\[LessEqual]", 
               RowBox[{"Length", "[", "matrixelements", "]"}]}], ",", 
              RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"delta", "=", 
                RowBox[{"matrixelements", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", ",", "1"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"dl", "=", 
                RowBox[{"delta", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"dm", "=", 
                RowBox[{"delta", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"l2", "=", 
                RowBox[{"p", "-", "dl"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"m2", " ", "=", " ", 
                RowBox[{"q", "-", "dm"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", " ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"l2", "\[GreaterEqual]", "0"}], " ", "&&", " ", 
                  RowBox[{"l2", "\[LessEqual]", "maxl"}], "&&", 
                  RowBox[{
                   RowBox[{"Abs", "[", "m2", "]"}], "\[LessEqual]", "l2"}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"col", " ", "=", " ", 
                   RowBox[{"1", "+", 
                    RowBox[{"l2", 
                    RowBox[{"(", 
                    RowBox[{"l2", "+", "1"}], ")"}]}], "+", "m2"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"value", "=", 
                   RowBox[{"Simplify", "[", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"matrixelements", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "2"}], "]"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"l", "\[Rule]", "l2"}], ",", 
                    RowBox[{"m", "\[Rule]", "m2"}]}], "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\[CapitalLambda]", ",", "stEff", ",", "l", ",", "m", ",",
                     "invPe"}], "}"}], "\[Element]", "Reals"}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"Not", "[", 
                    RowBox[{"value", "===", "0"}], "]"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"sparserules", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"row", ",", "col"}], "}"}], "\[Rule]", 
                    "value"}]}], "]"}]}], "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], "\[IndentingNewLine]", 
            RowBox[{"row", "++"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"SparseArray", "[", "sparserules", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.579272683739621*^9, 3.5792728008693204`*^9}, {
   3.579272846947956*^9, 3.5792729117716637`*^9}, {3.5792738818061466`*^9, 
   3.5792739162531166`*^9}, 3.5792739481409407`*^9, {3.5792744372079134`*^9, 
   3.5792744482535458`*^9}, {3.579275308617756*^9, 3.579275332153102*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test it", "Subtitle",
 CellChangeTimes->{{3.5792731007734737`*^9, 3.579273105212728*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxl", "=", "4"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"sparsetest", " ", "=", " ", 
   RowBox[{"assemblesparse", "[", "maxl", "]"}]}], ";"}], "\n", 
 RowBox[{"ByteCount", "[", "sparsetest", "]"}], "\n", 
 RowBox[{"MatrixPlot", "[", "sparsetest", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "sparsetest", "]"}]}], "Input",
 CellChangeTimes->{{3.579273106495801*^9, 3.5792731489972324`*^9}, {
  3.579273962479761*^9, 3.5792739733193808`*^9}, {3.5792740961584067`*^9, 
  3.5792741284782553`*^9}, {3.579275294565952*^9, 3.579275302333396*^9}}],

Cell[BoxData["25"], "Print",
 CellChangeTimes->{{3.5792731234757724`*^9, 3.579273149333252*^9}, {
  3.579273958720546*^9, 3.579273973914415*^9}, {3.5792740967744417`*^9, 
  3.5792741322894735`*^9}, {3.5792752903617115`*^9, 3.5792753342702227`*^9}}],

Cell[BoxData["32136"], "Output",
 CellChangeTimes->{{3.5792731235507765`*^9, 3.579273149345252*^9}, {
  3.579273958811551*^9, 3.579273974060423*^9}, {3.579274096789443*^9, 
  3.5792741341385794`*^9}, {3.579275291544779*^9, 3.579275334385229*^9}}],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJztmcEJwlAQBT9YhUcrSQ+WIHi2ZUuwBBE9ehFX9o07gTA5fD77J3MI5HC6
HM+7tdb+dT+en9dtY/O6rbdX91xUfuqT7p8+fxrtJ2MuKn/dT9r7SpuHTvth
7Z/Gaf2k+aTTfmrpeXvX0zntvGm90TntvPZTS89bu34ap/mxn1pO8+P3s/yG
9sNimk/7YZHu0356SfdpP71M82kPtZz2f9Z+amk/vevpnNZPWm900vtJ299+
WPvbQ+/8dD90//T56X7S/Kf5tB8p/4l36AzS3A==
   "], {{0, 0}, {25, 25}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{24.5, 
       FormBox["1", TraditionalForm]}, {20.5, 
       FormBox["5", TraditionalForm]}, {15.5, 
       FormBox["10", TraditionalForm]}, {10.5, 
       FormBox["15", TraditionalForm]}, {5.5, 
       FormBox["20", TraditionalForm]}, {0.5, 
       FormBox["25", TraditionalForm]}}, {{24.5, 
       FormBox["1", TraditionalForm]}, {20.5, 
       FormBox["5", TraditionalForm]}, {15.5, 
       FormBox["10", TraditionalForm]}, {10.5, 
       FormBox["15", TraditionalForm]}, {5.5, 
       FormBox["20", TraditionalForm]}, {0.5, 
       FormBox["25", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {4.5, 
       FormBox["5", TraditionalForm]}, {9.5, 
       FormBox["10", TraditionalForm]}, {14.5, 
       FormBox["15", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {24.5, 
       FormBox["25", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {4.5, 
       FormBox["5", TraditionalForm]}, {9.5, 
       FormBox["10", TraditionalForm]}, {14.5, 
       FormBox["15", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {24.5, 
       FormBox["25", TraditionalForm]}}}}]], "Output",
 CellChangeTimes->{{3.5792731235507765`*^9, 3.579273149345252*^9}, {
  3.579273958811551*^9, 3.579273974060423*^9}, {3.579274096789443*^9, 
  3.5792741341385794`*^9}, {3.579275291544779*^9, 3.5792753344072304`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["\[ImaginaryI]", "2"]}], "-", 
       RowBox[{"2", " ", "invPe"}]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[CapitalLambda]"}], "10"]}],
       "0", "0", "0", "0", "0", 
      RowBox[{"\[ImaginaryI]", " ", 
       SqrtBox[
        FractionBox["3", "70"]], " ", "\[CapitalLambda]"}], "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
        RowBox[{"5", " ", 
         SqrtBox["14"]}]]}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0"},
     {"0", "0", 
      RowBox[{
       RowBox[{"-", "2"}], " ", "invPe"}], "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
       SqrtBox["70"]], "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
        SqrtBox["70"]]}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      FractionBox[
       RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[CapitalLambda]"}], "10"], 
      "0", 
      RowBox[{
       FractionBox["\[ImaginaryI]", "2"], "-", 
       RowBox[{"2", " ", "invPe"}]}], "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
       RowBox[{"5", " ", 
        SqrtBox["14"]}]], "0", "0", "0", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       SqrtBox[
        FractionBox["3", "70"]], " ", "\[CapitalLambda]"}], "0", "0", "0", 
      "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"\[ImaginaryI]", " ", 
       SqrtBox[
        FractionBox["3", "10"]], " ", "\[CapitalLambda]"}], "0", "0", "0", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], "-", 
       RowBox[{"6", " ", "invPe"}]}], "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "7"]}], " ", "\[ImaginaryI]", " ", 
       SqrtBox[
        FractionBox["3", "2"]], " ", "\[CapitalLambda]"}], "0", "0", "0", "0",
       "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
       SqrtBox["21"]], "0", "0", "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "7"]}], " ", "\[ImaginaryI]", " ", 
       SqrtBox[
        FractionBox["2", "15"]], " ", "\[CapitalLambda]"}], "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["\[ImaginaryI]", "2"]}], "-", 
       RowBox[{"6", " ", "invPe"}]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[CapitalLambda]"}], "14"]}],
       "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"\[ImaginaryI]", " ", 
       SqrtBox[
        FractionBox["2", "21"]], " ", "\[CapitalLambda]"}], "0", "0", "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "7"]}], " ", "\[ImaginaryI]", " ", 
       SqrtBox[
        FractionBox["2", "3"]], " ", "\[CapitalLambda]"}], "0", "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{
       FractionBox["1", "7"], " ", "\[ImaginaryI]", " ", 
       SqrtBox[
        FractionBox["3", "2"]], " ", "\[CapitalLambda]"}], "0", 
      RowBox[{
       RowBox[{"-", "6"}], " ", "invPe"}], "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "7"]}], " ", "\[ImaginaryI]", " ", 
       SqrtBox[
        FractionBox["3", "2"]], " ", "\[CapitalLambda]"}], "0", "0", "0", "0",
       "0", "0", "0", "0", "0", 
      RowBox[{
       FractionBox["1", "7"], " ", "\[ImaginaryI]", " ", 
       SqrtBox["2"], " ", "\[CapitalLambda]"}], "0", "0", "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "7"]}], " ", "\[ImaginaryI]", " ", 
       SqrtBox["2"], " ", "\[CapitalLambda]"}], "0", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[CapitalLambda]"}], "14"], 
      "0", 
      RowBox[{
       FractionBox["\[ImaginaryI]", "2"], "-", 
       RowBox[{"6", " ", "invPe"}]}], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", 
      RowBox[{
       FractionBox["1", "7"], " ", "\[ImaginaryI]", " ", 
       SqrtBox[
        FractionBox["2", "3"]], " ", "\[CapitalLambda]"}], "0", "0", "0", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       SqrtBox[
        FractionBox["2", "21"]], " ", "\[CapitalLambda]"}], "0"},
     {
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       SqrtBox[
        FractionBox["3", "10"]], " ", "\[CapitalLambda]"}], "0", "0", "0", 
      "0", "0", 
      RowBox[{
       FractionBox["1", "7"], " ", "\[ImaginaryI]", " ", 
       SqrtBox[
        FractionBox["3", "2"]], " ", "\[CapitalLambda]"}], "0", 
      RowBox[{"\[ImaginaryI]", "-", 
       RowBox[{"6", " ", "invPe"}]}], "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", 
      RowBox[{
       FractionBox["1", "7"], " ", "\[ImaginaryI]", " ", 
       SqrtBox[
        FractionBox["2", "15"]], " ", "\[CapitalLambda]"}], "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
        SqrtBox["21"]]}]},
     {"0", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", 
       SqrtBox[
        FractionBox["6", "35"]], " ", "\[CapitalLambda]"}], "0", "0", "0", 
      "0", "0", "0", "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["3", "2"]}], " ", 
       RowBox[{"(", 
        RowBox[{"\[ImaginaryI]", "+", 
         RowBox[{"8", " ", "invPe"}]}], ")"}]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
        RowBox[{"2", " ", 
         SqrtBox["15"]}]]}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0"},
     {"0", "0", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", 
       SqrtBox[
        FractionBox["2", "35"]], " ", "\[CapitalLambda]"}], "0", "0", "0", 
      "0", "0", "0", "0", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], "-", 
       RowBox[{"12", " ", "invPe"}]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
        SqrtBox["30"]]}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", 
      RowBox[{
       FractionBox["2", "5"], " ", "\[ImaginaryI]", " ", 
       SqrtBox[
        FractionBox["2", "7"]], " ", "\[CapitalLambda]"}], "0", "0", "0", "0",
       "0", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
       RowBox[{"2", " ", 
        SqrtBox["15"]}]], "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["\[ImaginaryI]", "2"]}], "-", 
       RowBox[{"12", " ", "invPe"}]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "\[CapitalLambda]"}], "5"]}], "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
       SqrtBox["30"]], "0", 
      RowBox[{
       RowBox[{"-", "12"}], " ", "invPe"}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
        SqrtBox["30"]]}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["2", "5"]}], " ", "\[ImaginaryI]", " ", 
       SqrtBox[
        FractionBox["2", "7"]], " ", "\[CapitalLambda]"}], "0", "0", "0", "0",
       "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "\[CapitalLambda]"}], "5"], "0", 
      RowBox[{
       FractionBox["\[ImaginaryI]", "2"], "-", 
       RowBox[{"12", " ", "invPe"}]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
        RowBox[{"2", " ", 
         SqrtBox["15"]}]]}], "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{
       RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
       SqrtBox[
        FractionBox["2", "35"]], " ", "\[CapitalLambda]"}], "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
       SqrtBox["30"]], "0", 
      RowBox[{"\[ImaginaryI]", "-", 
       RowBox[{"12", " ", "invPe"}]}], "0", "0", "0", "0", "0", "0", "0", "0",
       "0", "0"},
     {"0", "0", "0", 
      RowBox[{
       RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
       SqrtBox[
        FractionBox["6", "35"]], " ", "\[CapitalLambda]"}], "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
       RowBox[{"2", " ", 
        SqrtBox["15"]}]], "0", 
      RowBox[{
       FractionBox[
        RowBox[{"3", " ", "\[ImaginaryI]"}], "2"], "-", 
       RowBox[{"12", " ", "invPe"}]}], "0", "0", "0", "0", "0", "0", "0", "0",
       "0"},
     {"0", "0", "0", "0", 
      FractionBox[
       RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
       SqrtBox["21"]], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "\[ImaginaryI]"}], "-", 
       RowBox[{"20", " ", "invPe"}]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
        RowBox[{"11", " ", 
         SqrtBox["7"]}]]}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
       SqrtBox["42"]], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"3", " ", "\[ImaginaryI]"}], "2"]}], "-", 
       RowBox[{"20", " ", "invPe"}]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"9", " ", "\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
        RowBox[{"22", " ", 
         SqrtBox["7"]}]]}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
       RowBox[{"7", " ", 
        SqrtBox["2"]}]], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
       RowBox[{"11", " ", 
        SqrtBox["7"]}]], "0", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], "-", 
       RowBox[{"20", " ", "invPe"}]}], "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["9", "77"]}], " ", "\[ImaginaryI]", " ", 
       SqrtBox[
        FractionBox["5", "2"]], " ", "\[CapitalLambda]"}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
       RowBox[{"7", " ", 
        SqrtBox["6"]}]], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      FractionBox[
       RowBox[{"9", " ", "\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
       RowBox[{"22", " ", 
        SqrtBox["7"]}]], "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["\[ImaginaryI]", "2"]}], "-", 
       RowBox[{"20", " ", "invPe"}]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"15", " ", "\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
        "77"]}], "0", "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "7"]}], " ", "\[ImaginaryI]", " ", 
       SqrtBox[
        FractionBox["5", "6"]], " ", "\[CapitalLambda]"}], "0", "0", "0", 
      RowBox[{
       FractionBox["1", "7"], " ", "\[ImaginaryI]", " ", 
       SqrtBox[
        FractionBox["5", "6"]], " ", "\[CapitalLambda]"}], "0", "0", "0", "0",
       "0", "0", "0", "0", "0", 
      RowBox[{
       FractionBox["9", "77"], " ", "\[ImaginaryI]", " ", 
       SqrtBox[
        FractionBox["5", "2"]], " ", "\[CapitalLambda]"}], "0", 
      RowBox[{
       RowBox[{"-", "20"}], " ", "invPe"}], "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["9", "77"]}], " ", "\[ImaginaryI]", " ", 
       SqrtBox[
        FractionBox["5", "2"]], " ", "\[CapitalLambda]"}], "0", "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
        RowBox[{"7", " ", 
         SqrtBox["6"]}]]}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", 
      FractionBox[
       RowBox[{"15", " ", "\[ImaginaryI]", " ", "\[CapitalLambda]"}], "77"], 
      "0", 
      RowBox[{
       FractionBox["\[ImaginaryI]", "2"], "-", 
       RowBox[{"20", " ", "invPe"}]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"9", " ", "\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
        RowBox[{"22", " ", 
         SqrtBox["7"]}]]}], "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
        RowBox[{"7", " ", 
         SqrtBox["2"]}]]}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", 
      RowBox[{
       FractionBox["9", "77"], " ", "\[ImaginaryI]", " ", 
       SqrtBox[
        FractionBox["5", "2"]], " ", "\[CapitalLambda]"}], "0", 
      RowBox[{"\[ImaginaryI]", "-", 
       RowBox[{"20", " ", "invPe"}]}], "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
        RowBox[{"11", " ", 
         SqrtBox["7"]}]]}]},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
        SqrtBox["42"]]}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", 
      FractionBox[
       RowBox[{"9", " ", "\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
       RowBox[{"22", " ", 
        SqrtBox["7"]}]], "0", 
      RowBox[{
       FractionBox[
        RowBox[{"3", " ", "\[ImaginaryI]"}], "2"], "-", 
       RowBox[{"20", " ", "invPe"}]}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"5", " ", "\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
        SqrtBox["21"]]}], "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", 
      FractionBox[
       RowBox[{"3", " ", "\[ImaginaryI]", " ", "\[CapitalLambda]"}], 
       RowBox[{"11", " ", 
        SqrtBox["7"]}]], "0", 
      RowBox[{
       RowBox[{"2", " ", "\[ImaginaryI]"}], "-", 
       RowBox[{"20", " ", "invPe"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {25, 25}, 0, {
     1, {{0, 0, 4, 7, 11, 16, 20, 25, 29, 34, 37, 40, 44, 47, 51, 54, 57, 60, 
       63, 67, 71, 76, 80, 84, 87, 90}, {{2}, {4}, {10}, {14}, {3}, {11}, {
       15}, {2}, {4}, {12}, {16}, {1}, {5}, {7}, {17}, {21}, {6}, {8}, {18}, {
       22}, {5}, {7}, {9}, {19}, {23}, {6}, {8}, {20}, {24}, {1}, {7}, {9}, {
       21}, {25}, {2}, {10}, {12}, {3}, {11}, {13}, {4}, {10}, {12}, {14}, {
       11}, {13}, {15}, {2}, {12}, {14}, {16}, {3}, {13}, {15}, {4}, {14}, {
       16}, {5}, {17}, {19}, {6}, {18}, {20}, {7}, {17}, {19}, {21}, {8}, {
       18}, {20}, {22}, {5}, {9}, {19}, {21}, {23}, {6}, {20}, {22}, {24}, {
       7}, {21}, {23}, {25}, {8}, {22}, {24}, {9}, {23}, {25}}}, {
      Complex[0, Rational[-1, 2]] - 2 $CellContext`invPe, 
       Complex[0, Rational[-3, 10]] $CellContext`\[CapitalLambda], 
       Complex[0, 1] 
       Rational[3, 70]^Rational[1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[-1, 5]] 
       14^Rational[-1, 
          2] $CellContext`\[CapitalLambda], (-2) $CellContext`invPe, 
       Complex[0, 1] 70^Rational[-1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, -1] 70^Rational[-1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[3, 10]] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[1, 2]] - 2 $CellContext`invPe, 
       Complex[0, Rational[1, 5]] 
       14^Rational[-1, 2] $CellContext`\[CapitalLambda], Complex[0, -1] 
       Rational[3, 70]^Rational[1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, 1] 
       Rational[3, 10]^Rational[1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, -1] - 6 $CellContext`invPe, Complex[0, Rational[-1, 7]] 
       Rational[3, 2]^Rational[1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, 2] 21^Rational[-1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[-1, 7]] 
       Rational[2, 15]^Rational[1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[-1, 2]] - 6 $CellContext`invPe, 
       Complex[0, Rational[-3, 14]] $CellContext`\[CapitalLambda], 
       Complex[0, 1] 
       Rational[2, 21]^Rational[1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[-1, 7]] 
       Rational[2, 3]^Rational[1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[1, 7]] 
       Rational[3, 2]^
        Rational[1, 2] $CellContext`\[CapitalLambda], (-6) $CellContext`invPe,
        Complex[0, Rational[-1, 7]] 
       Rational[3, 2]^Rational[1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[1, 7]] 
       2^Rational[1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[-1, 7]] 
       2^Rational[1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[3, 14]] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[1, 2]] - 6 $CellContext`invPe, 
       Complex[0, Rational[1, 7]] 
       Rational[2, 3]^Rational[1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, -1] 
       Rational[2, 21]^Rational[1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, -1] 
       Rational[3, 10]^Rational[1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[1, 7]] 
       Rational[3, 2]^Rational[1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, 1] - 6 $CellContext`invPe, Complex[0, Rational[1, 7]] 
       Rational[2, 15]^Rational[1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, -2] 21^Rational[-1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, 2] 
       Rational[6, 35]^Rational[1, 2] $CellContext`\[CapitalLambda], 
       Rational[-3, 2] (Complex[0, 1] + 8 $CellContext`invPe), 
       Complex[0, Rational[-1, 2]] 
       15^Rational[-1, 2] $CellContext`\[CapitalLambda], Complex[0, 2] 
       Rational[2, 35]^Rational[1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, -1] - 12 $CellContext`invPe, Complex[0, -1] 
       30^Rational[-1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[2, 5]] 
       Rational[2, 7]^Rational[1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[1, 2]] 
       15^Rational[-1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[-1, 2]] - 12 $CellContext`invPe, 
       Complex[0, Rational[-1, 5]] $CellContext`\[CapitalLambda], 
       Complex[0, 1] 
       30^Rational[-1, 
          2] $CellContext`\[CapitalLambda], (-12) $CellContext`invPe, 
       Complex[0, -1] 30^Rational[-1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[-2, 5]] 
       Rational[2, 7]^Rational[1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[1, 5]] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[1, 2]] - 12 $CellContext`invPe, 
       Complex[0, Rational[-1, 2]] 
       15^Rational[-1, 2] $CellContext`\[CapitalLambda], Complex[0, -2] 
       Rational[2, 35]^Rational[1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, 1] 30^Rational[-1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, 1] - 12 $CellContext`invPe, Complex[0, -2] 
       Rational[6, 35]^Rational[1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[1, 2]] 
       15^Rational[-1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[3, 2]] - 12 $CellContext`invPe, Complex[0, 5] 
       21^Rational[-1, 2] $CellContext`\[CapitalLambda], Complex[0, -2] - 
       20 $CellContext`invPe, Complex[0, Rational[-3, 11]] 
       7^Rational[-1, 2] $CellContext`\[CapitalLambda], Complex[0, 5] 
       42^Rational[-1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[-3, 2]] - 20 $CellContext`invPe, 
       Complex[0, Rational[-9, 22]] 
       7^Rational[-1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[5, 7]] 
       2^Rational[-1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[3, 11]] 
       7^Rational[-1, 2] $CellContext`\[CapitalLambda], Complex[0, -1] - 
       20 $CellContext`invPe, Complex[0, Rational[-9, 77]] 
       Rational[5, 2]^Rational[1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[5, 7]] 
       6^Rational[-1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[9, 22]] 
       7^Rational[-1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[-1, 2]] - 20 $CellContext`invPe, 
       Complex[0, Rational[-15, 77]] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[-1, 7]] 
       Rational[5, 6]^Rational[1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[1, 7]] 
       Rational[5, 6]^Rational[1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[9, 77]] 
       Rational[5, 2]^
        Rational[
         1, 2] $CellContext`\[CapitalLambda], (-20) $CellContext`invPe, 
       Complex[0, Rational[-9, 77]] 
       Rational[5, 2]^Rational[1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[-5, 7]] 
       6^Rational[-1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[15, 77]] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[1, 2]] - 20 $CellContext`invPe, 
       Complex[0, Rational[-9, 22]] 
       7^Rational[-1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[-5, 7]] 
       2^Rational[-1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[9, 77]] 
       Rational[5, 2]^Rational[1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, 1] - 20 $CellContext`invPe, Complex[0, Rational[-3, 11]] 
       7^Rational[-1, 2] $CellContext`\[CapitalLambda], Complex[0, -5] 
       42^Rational[-1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[9, 22]] 
       7^Rational[-1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[3, 2]] - 20 $CellContext`invPe, Complex[0, -5] 
       21^Rational[-1, 2] $CellContext`\[CapitalLambda], 
       Complex[0, Rational[3, 11]] 
       7^Rational[-1, 2] $CellContext`\[CapitalLambda], Complex[0, 2] - 
       20 $CellContext`invPe}}]]]]], "Output",
 CellChangeTimes->{{3.5792731235507765`*^9, 3.579273149345252*^9}, {
  3.579273958811551*^9, 3.579273974060423*^9}, {3.579274096789443*^9, 
  3.5792741341385794`*^9}, {3.579275291544779*^9, 3.579275334425232*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Augmented matrix, even l,m", "Section",
 CellChangeTimes->{{3.5792741591580105`*^9, 3.579274167965514*^9}}],

Cell["\<\
Here we\[CloseCurlyQuote]ll save the real and imaginary parts of c_lm as \
separate elements, so if we want to we can export from mathematica and use \
any sparse solver we like.\
\>", "Text",
 CellChangeTimes->{{3.5792742514122868`*^9, 3.5792742540974407`*^9}, {
  3.579274295267795*^9, 3.5792743258925467`*^9}}],

Cell["\<\
sparseindex[l,m] gives the index of the real part of c_lm, the imaginary is \
the next index\
\>", "Text",
 CellChangeTimes->{{3.579274330443807*^9, 3.5792743513640037`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sparseindex", "[", 
    RowBox[{"l_Integer", ",", "m_Integer"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"m", "+", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["l", "2"], ")"}], "2"], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
      RowBox[{"KroneckerDelta", "[", 
       RowBox[{"0", ",", "m"}], "]"}]}]}], "/;", 
    RowBox[{
     RowBox[{"EvenQ", "[", "l", "]"}], "&&", 
     RowBox[{"EvenQ", "[", "m", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Computed", " ", 
      RowBox[{"from", ":", " ", 
       RowBox[{"sparseindex", "[", 
        RowBox[{"l_", ",", "m_"}], "]"}]}]}], ":=", " ", 
     RowBox[{"1", " ", "+", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"1", "+", "k"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", 
          RowBox[{"l", "-", "2"}], ",", "2"}], "}"}]}], "]"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{"m", ",", "0"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"m", "-", "1"}], ")"}]}]}]}], ";"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.579274277502779*^9, 3.579274283773138*^9}}],

Cell["\<\
These are the functions that do the actual assembling.\
\>", "Text",
 CellChangeTimes->{{3.579274394355463*^9, 3.579274401523873*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AppendRules", "[", 
    RowBox[{"list_", ",", 
     RowBox[{"pos_", "\[Rule]", "val_"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"existingpos", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"list", ",", 
         RowBox[{"pos", "\[Rule]", "_"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "existingpos", "]"}], "\[Equal]", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Append", "[", 
         RowBox[{"list", ",", 
          RowBox[{"pos", "\[Rule]", "val"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"existingpos", "=", 
          RowBox[{"existingpos", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"existingrule", " ", "=", " ", 
          RowBox[{"list", "[", 
           RowBox[{"[", "existingpos", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"newrule", " ", "=", " ", 
          RowBox[{"existingrule", " ", "/.", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"pos", "\[Rule]", "x_"}], ")"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"pos", "\[Rule]", 
              RowBox[{"x", "+", "val"}]}], ")"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"list", ",", 
           RowBox[{"existingpos", "\[Rule]", "newrule"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"assemblesparseoptimised", "[", "maxl_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "row", ",", "p", ",", "q", ",", "col", ",", "dl", ",", "dm", ",", "l2",
         ",", "m2", ",", "sparserules", ",", "value", ",", "size", ",", "k", 
        ",", "delta", ",", "temprules", ",", "m2sign", ",", "m2magn", ",", 
        "recol", ",", "imcol", ",", "revalue", ",", "imvalue"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"size", " ", "=", 
        RowBox[{
         RowBox[{"sparseindex", "[", 
          RowBox[{"maxl", ",", "maxl"}], "]"}], "+", "1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "size", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"row", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"sparserules", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"p", "=", "0"}], ",", 
         RowBox[{"p", "<=", "maxl"}], ",", 
         RowBox[{"p", "+=", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"q", "=", "0"}], ",", 
            RowBox[{"q", "\[LessEqual]", "p"}], ",", 
            RowBox[{"q", "+=", "2"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"temprules", " ", "=", " ", 
              RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"k", "=", "1"}], ",", 
               RowBox[{"k", "\[LessEqual]", 
                RowBox[{"Length", "[", "matrixelements", "]"}]}], ",", 
               RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"delta", "=", 
                 RowBox[{"matrixelements", "[", 
                  RowBox[{"[", 
                   RowBox[{"k", ",", "1"}], "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"dl", "=", 
                 RowBox[{"delta", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"dm", "=", 
                 RowBox[{"delta", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"l2", "=", 
                 RowBox[{"p", "-", "dl"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"m2", " ", "=", " ", 
                 RowBox[{"q", "-", "dm"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"m2sign", " ", "=", " ", 
                 RowBox[{"Sign", "[", "m2", "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"m2magn", "=", 
                 RowBox[{"Abs", "[", "m2", "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", " ", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"l2", "\[GreaterEqual]", "0"}], " ", "&&", " ", 
                   RowBox[{"l2", "\[LessEqual]", "maxl"}], "&&", 
                   RowBox[{
                    RowBox[{"Abs", "[", "m2", "]"}], "\[LessEqual]", "l2"}]}],
                   ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"recol", " ", "=", " ", 
                    RowBox[{"sparseindex", "[", 
                    RowBox[{"l2", ",", "m2magn"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"imcol", " ", "=", " ", 
                    RowBox[{"recol", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"value", "=", 
                    RowBox[{"Simplify", "[", " ", 
                    RowBox[{
                    RowBox[{"matrixelements", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "2"}], "]"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"l", "\[Rule]", "l2"}], ",", 
                    RowBox[{"m", "\[Rule]", "m2"}]}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"revalue", "=", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{
                    RowBox[{"Re", "[", "value", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalLambda]", "\[Element]", "Reals"}], ",", 
                    RowBox[{"invPe", "\[Element]", "Reals"}], ",", 
                    RowBox[{"stEff", "\[Element]", "Reals"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"imvalue", "=", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{
                    RowBox[{"Im", "[", "value", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[CapitalLambda]", "\[Element]", "Reals"}], ",", 
                    RowBox[{"invPe", "\[Element]", "Reals"}], ",", 
                    RowBox[{"stEff", "\[Element]", "Reals"}]}], "}"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{"Row", " ", "for", " ", "real", " ", "value"}], 
                    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"Not", "[", 
                    RowBox[{"revalue", "===", "0"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"temprules", "=", 
                    RowBox[{"AppendRules", "[", 
                    RowBox[{"temprules", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"row", ",", "recol"}], "}"}], "\[Rule]", 
                    "revalue"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
                    "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Not", "[", 
                    RowBox[{"imvalue", "===", "0"}], "]"}], "&&", 
                    RowBox[{"Not", "[", 
                    RowBox[{"m2", "\[Equal]", "0"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"temprules", "=", 
                    RowBox[{"AppendRules", "[", 
                    RowBox[{"temprules", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"row", ",", "imcol"}], "}"}], "\[Rule]", 
                    RowBox[{
                    RowBox[{"-", "imvalue"}], " ", "m2sign"}]}]}], "]"}]}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    "Row", " ", "for", " ", "imaginory", " ", "value"}], 
                    "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"Not", "[", 
                    RowBox[{"q", "\[Equal]", "0"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Not", "[", 
                    RowBox[{"revalue", "===", "0"}], "]"}], "&&", 
                    RowBox[{"Not", "[", 
                    RowBox[{"m2", "\[Equal]", "0"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"temprules", "=", 
                    RowBox[{"AppendRules", "[", 
                    RowBox[{"temprules", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"row", "+", "1"}], ",", "imcol"}], "}"}], 
                    "\[Rule]", 
                    RowBox[{"revalue", " ", "m2sign"}]}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"Not", "[", 
                    RowBox[{"imvalue", "===", "0"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"temprules", "=", 
                    RowBox[{"AppendRules", "[", 
                    RowBox[{"temprules", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"row", "+", "1"}], ",", "recol"}], "}"}], 
                    "\[Rule]", "imvalue"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}],
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"sparserules", " ", "=", " ", 
              RowBox[{"Join", "[", 
               RowBox[{"sparserules", ",", "temprules"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"row", "+=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"q", "\[Equal]", "0"}], ",", "1", ",", "2"}], "]"}]}],
              ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"PrintTemporary", "[", "p", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"SparseArray", "[", "sparserules", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], "/;", 
    RowBox[{"EvenQ", "[", "maxl", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5792743884931273`*^9, 3.579274389455182*^9}, {
  3.579275360476722*^9, 3.579275389501382*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test it", "Subtitle",
 CellChangeTimes->{{3.5792754862679167`*^9, 3.579275489708113*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxl", "=", "12"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"sparsetest", " ", "=", " ", 
   RowBox[{"assemblesparseoptimised", "[", "maxl", "]"}]}], ";"}], "\n", 
 RowBox[{"ByteCount", "[", "sparsetest", "]"}], "\n", 
 RowBox[{"MatrixPlot", "[", "sparsetest", "]"}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"MatrixForm", "[", "sparsetest", "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.579275491119194*^9, 3.5792755117643747`*^9}}],

Cell[BoxData["49"], "Print",
 CellChangeTimes->{{3.5792754988316355`*^9, 3.5792755120353904`*^9}}],

Cell[BoxData["78152"], "Output",
 CellChangeTimes->{{3.579275498906639*^9, 3.5792755125574203`*^9}}],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJzt201IVFEUwHHJVgWRfVBUoxi1iFZBEYpwwYggXKWFZDASSAsLVxVUiyA/
sEUQKCEFbQLBICikCAoxcSOWRWWJ2IyBhDrShxm1kBrThfjQGZ15991z5j8P
+cmgz3OP5x7evHdv/umaY1XZWVlZ++a+Zr6ffX0ziJis0TkXvoKOy/083Gm5
HT8GF/we+UR0aZ7qdLE8eN9/c//1zGE21ObEj07zvOFZ/Ig5Mg7EIKWfzJp8
HmreN6+70TVhyu692N3xIGLCub1dW6+eTXAe8oxoc57qNvk+U3Izei58ps/0
rXlS0F75znSsr/y4tn+cPCP6XudS5lHycUba9oZ2NIybug8/y78PD5uT/69/
riQ4j5Q8ILos/WrpOL3v/+rJqw1dfGmaS6sehv9GTGdL9p6KXVz/INJPlh9n
UeXMETMXbp2PHyMmlJMbP14lOI+UPCC6LP1q6Ti977c3bGwsi701kzVD/Tuv
fzZNl1uLth0fU5IHxFSknyw3zsmDg9OnCiZMf/Gnpj8lo+bIVH5h3t2hBOeR
kgdEl6VfLR2n9/3NT3uKt4cGTHXp4e7mTSOmMVr/Y6BuVEkeEP0wXfUvfR55
428sLY9UnIiZqaOrvxaGx0zbgfpL1yLDCcYrPQ+ImaD0eeqNf7r4Ue+q1qg5
tP/3lpbHX0zPQPd0Nc+/EANU6/xa7ri05gHRD7XOF7/3XwQ9Plf+v9Lzg7LU
Wm9+77+QIv0Kbaq1Hth/YSdOKXlAHWqtN/Zf2IlTSh7Qjlrrjf0XduKUkgfU
odZ6Zv+FnTil5AHtqLXe2H9hJ04peUAdaq1n9l/YiVNKHjBYte7XYP9FeuOX
ngfE+bpWz+y/SK/kAV1QSh2y/2Jlkgf0Qyl15ff6Q/fH5eb5EW0qpZ79Xn/o
2riknB9xvlLqTev6Q/oJor561rr+kH6FmpRSz1rXH0rJP6ILSpkvWtcfSsk/
YipKWc+mdf2hlPwjatJ+v2L9YSaMC3G+Uj6/aJ2PWseFunW/b6zs+buU/NA3
EN2fL34/f5eSH/oVatK1fuL9+WCfv9NPEN3RtX7l2vN3+hWiO3We+v1hN5+/
S+lXiOjffMy05+9S4kR0WXeur9IzHlfzg6hJKfu/gprX9A1Ed5Sy/yuofkK/
QnRnHgV1/5n7yYiY+nyXdf+ZfoXovq5d56Qr/qDzipiJJt9Pgl3/Q99AxMVM
1+cv/+Kx83cR0b7cZ0ZERET8B+Ivbng=
   "], {{0, 0}, {49, 49}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{48.5, 
       FormBox["1", TraditionalForm]}, {39.5, 
       FormBox["10", TraditionalForm]}, {29.5, 
       FormBox["20", TraditionalForm]}, {19.5, 
       FormBox["30", TraditionalForm]}, {9.5, 
       FormBox["40", TraditionalForm]}, {0.5, 
       FormBox["49", TraditionalForm]}}, {{48.5, 
       FormBox["1", TraditionalForm]}, {39.5, 
       FormBox["10", TraditionalForm]}, {29.5, 
       FormBox["20", TraditionalForm]}, {19.5, 
       FormBox["30", TraditionalForm]}, {9.5, 
       FormBox["40", TraditionalForm]}, {0.5, 
       FormBox["49", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {9.5, 
       FormBox["10", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {29.5, 
       FormBox["30", TraditionalForm]}, {39.5, 
       FormBox["40", TraditionalForm]}, {48.5, 
       FormBox["49", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {9.5, 
       FormBox["10", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {29.5, 
       FormBox["30", TraditionalForm]}, {39.5, 
       FormBox["40", TraditionalForm]}, {48.5, 
       FormBox["49", TraditionalForm]}}}}]], "Output",
 CellChangeTimes->{{3.579275498906639*^9, 3.5792755125794215`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Assemble up to some size, and save it to a .mx file \
(platform specific, dont transfer .mx around)", "Section"]], "Section",
 CellChangeTimes->{3.5792758843376846`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxl", " ", "=", " ", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"sparseOptimised", "=", 
  RowBox[{
  "assemblesparseoptimised", "[", "maxl", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sparseAugmented", " ", "=", " ", 
   RowBox[{"sparseOptimised", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"2", ";;"}], ",", 
      RowBox[{"2", ";;"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"augmentedB", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"sparseOptimised", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"2", ";;"}], ",", "1"}], "]"}], "]"}]}], " ", "*", " ", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{"Sqrt", "[", "Pi", "]"}]}], ")"}]}]}], "//", "Normal"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"DumpSave", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{"StringForm", "[", 
     RowBox[{"\"\<augmentedMatrix_lmax``.mx\>\"", ",", "maxl"}], "]"}], "]"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"sparseAugmented", ",", "augmentedB"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.579275533812636*^9, 3.5792756206846046`*^9}, {
  3.5792756819641094`*^9, 3.579275728755786*^9}, {3.579275795683614*^9, 
  3.579275801018919*^9}}],

Cell[BoxData["121"], "Print",
 CellChangeTimes->{3.5792757295678325`*^9, 3.579275801315936*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"SparseArray", "[", 
   RowBox[{
    InterpretationBox[
     RowBox[{"\<\"<\"\>", "\[InvisibleSpace]", "791", 
      "\[InvisibleSpace]", "\<\">\"\>"}],
     SequenceForm["<", 791, ">"],
     Editable->False], ",", 
    RowBox[{"{", 
     RowBox[{"121", ",", "121"}], "}"}]}], "]"}],
  False,
  Editable->False]], "Output",
 CellChangeTimes->{3.5792757310219154`*^9, 3.57927580295503*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"SparseArray", "[", 
     RowBox[{
      InterpretationBox[
       RowBox[{"\<\"<\"\>", "\[InvisibleSpace]", "790", 
        "\[InvisibleSpace]", "\<\">\"\>"}],
       SequenceForm["<", 790, ">"],
       Editable->False], ",", 
      RowBox[{"{", 
       RowBox[{"120", ",", "120"}], "}"}]}], "]"}],
    False,
    Editable->False], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SqrtBox[
       FractionBox["3", 
        RowBox[{"10", " ", "\[Pi]"}]]], " ", "\[CapitalLambda]"}], ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.5792757310219154`*^9, 3.579275802968031*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.579275657354702*^9, 3.5792756655401707`*^9}, 
   3.5792757234824843`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["See if it works", "Subtitle",
 CellChangeTimes->{{3.579275904464836*^9, 3.5792759068489723`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"sparseAugmented", ",", "augmentedB"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{"ToString", "[", 
   RowBox[{"StringForm", "[", 
    RowBox[{"\"\<augmentedMatrix_lmax``.mx\>\"", ",", "maxl"}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "sparseAugmented", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixPlot", "[", "sparseAugmented", "]"}]}], "Input",
 CellChangeTimes->{{3.5792758134396296`*^9, 3.579275848897658*^9}, {
  3.5792759091221027`*^9, 3.5792759150494413`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"120", ",", "120"}], "}"}]], "Output",
 CellChangeTimes->{3.5792758493286824`*^9, 3.5792759153414583`*^9}],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJzt3G9oVXUcx/FRT1zJaJVF4NJRrgLBJSZNhO+Yj8IQczaqJ5V/KR+kWA0m
7kENZHMyKgRvmmNCDzK3FVGs2MRQ0IW6iWy6FnfXPzl2d2chPpgPJm5sj3Y5
bvfunnu+399538N4jbsf53zP9+z34XA4/Ao3fbJh66M5OTmrp34mfp/8/C+I
iMEYm3L6x+v7oOvNdh+CrgsR3ZccDuf5IqIeU81hV3Pbev2IaFdy2I36EdGu
5LAb9SOiXclhN+pHRLuSw27Uj4h2JYfdqB8R7UoOu1E/IrqnqzlsvX5EDI+p
5pK2HPOu50jk8PjWP+3v1vPZ+vVCxNnPUyvzN7nOvwuPN9Z8fFuiw9cWxvdG
5YuDP9XlF2/xHH/px+6JTZ6syR/f/pSOfe3jW0LJ+c31elm/vohh0Pr8Ta7n
lzUbJbcnIU8senr9wp9jUzn8qef4qsV5GwpGu+Tgay/WPzvWLZ3z+j8YyE3M
0B8955vZ74P+f0QMo9bndfJxW07t2inHhuXE5t7qpneuS9v9yIeVRcc8x5cP
Vb0ZOXRRCn+QiqLX+6Sn9l7JI/XDM/SH64WIzGuv4za0NiyfvzohB/5q61px
76bEv4kcKlvR6Tn+zp7a5nWnL0qi5Pja++tjcqNlyfzdj5HDiMi8Trf+nUeb
717tSciOVw8vPhcZlHkbt53Y/V+v5/hl/e+ujOZdlgstl9/7o+C6xG5dyfu+
Mj5Df7heiMi89jpuX/Wq347kjEj0zPbh2q+G5PzX/7z83EsDnuO3jd5esKC9
V1pfGPvo8/gNiT5fl3/l5tAM/eF6ISLz2uu4bWe/K730fkLe+LVs/4XyuAyM
rX2r7+Q1z/Hrlu66+vYr/dL0+J3IMx3/St/Ris+qR8hhRGRez83Z17np95LS
8j0xWXWquPHLbwdle8Po4JKneD6MiFq1Pq/DlleunhdiGHR1/lqpn/teRHR1
XlupnxxGRFdzQFs9Yes/IpID2uoJW/8RkRzQVk/Y+o+I5IC2esLWf0QkB7TV
E7b+I6KefNBWZ9B9da3/iJj9HMjU+LnXk+r6w9mpM6h+ksOI7qk/xzK7/rC2
fmrrPyJmX235kLx/W+sPk8OIaD03kvdja/1hbf1ERP1qy43k/dhaf1hbPxFR
v9pyI3k/ttYf1tZPRNSvldyY/XGDXX/YSj8R0a7acsN6vlmpExHJh1Tr1NYf
K/1ERD1ayQ1yGBFd1UrOkMOI6KpWcoYcRkRXtZIz5DAihk097xVndv/W+4OI
4TH764mlur5EesfVc77p1YmI4dH6+hJ+ny/3vYjot37nj7b1JchhRNSm37mk
bX0JchgRtRlULgW1vgQ5jIjW1fYehbZ1foK+Pojojtpyz+/6yVtE1CY5nNl6
EBFTVdtzYyv1IyL6bfbfr5hbvX7VH/R1QMTwmv33h9P73r/6Hz4eEdFvrbw/
zH0vIrpq9p9LpPf+MDmMiDiptufJ5DAiumpQOcl9LyLiw9V2f0sOIyJOqu25
RND9QETUIs8fEBG1+QDDsdNr
   "], {{0, 0}, {60, 60}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{59.75, 
       FormBox["1", TraditionalForm]}, {35.25, 
       FormBox["50", TraditionalForm]}, {0.25, 
       FormBox["120", TraditionalForm]}}, {{59.75, 
       FormBox["1", TraditionalForm]}, {35.25, 
       FormBox["50", TraditionalForm]}, {0.25, 
       FormBox["120", TraditionalForm]}}}, {{{0.25, 
       FormBox["1", TraditionalForm]}, {24.75, 
       FormBox["50", TraditionalForm]}, {59.75, 
       FormBox["120", TraditionalForm]}}, {{0.25, 
       FormBox["1", TraditionalForm]}, {24.75, 
       FormBox["50", TraditionalForm]}, {59.75, 
       FormBox["120", TraditionalForm]}}}}]], "Output",
 CellChangeTimes->{3.5792758493286824`*^9, 3.579275915392461*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.57927584071019*^9, 3.5792758414582324`*^9}}]
}, Open  ]]
}, Open  ]]
},
Evaluator->"Sixth",
WindowSize->{1241, 947},
WindowMargins->{{407, Automatic}, {Automatic, 108}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (November 20, 2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 142, 3, 90, "Title"],
Cell[724, 27, 430, 8, 85, "Subsubtitle"],
Cell[1157, 37, 359, 7, 68, "Text"],
Cell[CellGroupData[{
Cell[1541, 48, 143, 3, 79, "Section"],
Cell[1687, 53, 169, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[1881, 60, 30317, 791, 662, "Input"],
Cell[32201, 853, 29461, 788, 673, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[61711, 1647, 115, 1, 79, "Section"],
Cell[61829, 1650, 5052, 111, 492, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66918, 1766, 95, 1, 49, "Subtitle"],
Cell[CellGroupData[{
Cell[67038, 1771, 589, 11, 112, "Input"],
Cell[67630, 1784, 248, 3, 23, "Print"],
Cell[67881, 1789, 246, 3, 31, "Output"],
Cell[68130, 1794, 1809, 37, 378, "Output"],
Cell[69942, 1833, 23306, 548, 1025, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93285, 2386, 113, 1, 79, "Section"],
Cell[93401, 2389, 323, 6, 30, "Text"],
Cell[93727, 2397, 184, 4, 30, "Text"],
Cell[93914, 2403, 1359, 41, 69, "Input"],
Cell[95276, 2446, 144, 3, 30, "Text"],
Cell[95423, 2451, 11870, 261, 1252, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[107342, 2718, 95, 1, 49, "Subtitle"],
Cell[CellGroupData[{
Cell[107462, 2723, 471, 11, 112, "Input"],
Cell[107936, 2736, 98, 1, 23, "Print"],
Cell[108037, 2739, 100, 1, 31, "Output"],
Cell[108140, 2742, 2635, 51, 378, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110812, 2798, 193, 2, 113, "Section"],
Cell[CellGroupData[{
Cell[111030, 2804, 1314, 37, 112, "Input"],
Cell[112347, 2843, 95, 1, 23, "Print"],
Cell[112445, 2846, 421, 13, 31, "Output"],
Cell[112869, 2861, 1974, 39, 107, "Output"]
}, Open  ]],
Cell[114858, 2903, 122, 2, 31, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[115029, 2911, 103, 1, 49, "Subtitle"],
Cell[CellGroupData[{
Cell[115157, 2916, 579, 12, 92, "Input"],
Cell[115739, 2930, 145, 3, 31, "Output"],
Cell[115887, 2935, 2374, 44, 400, "Output"]
}, Open  ]],
Cell[118276, 2982, 93, 1, 31, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
