(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    101113,       3081]
NotebookOptionsPosition[     97662,       2966]
NotebookOutlinePosition[     98029,       2982]
CellTagsIndexPosition[     97986,       2979]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Compute matrix elements of Fokker-Planck Equation on the sphere.\
\>", "Title",
 CellChangeTimes->{{3.579268426814139*^9, 3.579268448045353*^9}}],

Cell[TextData[{
 "This notebook starts from the operator J = \[Del]n + ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Del]", "2"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and computes the matrix elements <p,q | J | l, m> using operator formalism."
}], "Text",
 CellChangeTimes->{{3.579268458204934*^9, 3.5792685473570337`*^9}}],

Cell["\<\
Notation will be
n[i], L[i] and Lsqr are operators, y[l,m] are the symbolic spherical \
harmonics. The following functions are used to determine if an expression is \
an operator.\
\>", "Text",
 CellChangeTimes->{{3.5792695048057966`*^9, 3.579269614005042*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"operatorlist", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "[", "_", "]"}], ",", 
     RowBox[{"L", "[", "_", "]"}], ",", "Lsqr", ",", 
     RowBox[{"y", "[", 
      RowBox[{"_", ",", "_"}], "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"notOperator", "[", "expr_", "]"}], ":=", 
   RowBox[{"And", "@@", " ", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FreeQ", "[", 
        RowBox[{"expr", ",", "#"}], "]"}], "&"}], ",", "operatorlist"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"isOperator", "[", "expr_", "]"}], ":=", 
   RowBox[{"Not", "[", 
    RowBox[{"notOperator", "[", "expr", "]"}], "]"}]}], ";"}]}], "Input"],

Cell["\<\
Setup the operator on original form, using L[i] and n[i]\
\>", "Section",
 CellChangeTimes->{{3.579268607700485*^9, 3.579268654555165*^9}}],

Cell[CellGroupData[{

Cell["\<\
The gradient, and helper tensors\
\>", "Subtitle",
 CellChangeTimes->{{3.5792686664118433`*^9, 3.579268693507393*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"amat", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"omat", " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{"amat", "-", 
      RowBox[{"amat", "\[Transpose]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"smat", " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{"amat", "+", 
      RowBox[{"amat", "\[Transpose]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"omega", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"-", 
      RowBox[{"omat", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bmat", " ", "=", " ", 
   RowBox[{"omat", " ", "+", " ", 
    RowBox[{"\[CapitalLambda]", " ", "smat"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"bbmat", " ", "=", " ", 
  RowBox[{
   RowBox[{"omat", ".", "omat"}], "+", 
   RowBox[{"smat", ".", "omat"}], "+", 
   RowBox[{"\[CapitalLambda]", " ", 
    RowBox[{"smat", ".", "smat"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]", "=", 
   RowBox[{
    RowBox[{"LeviCivitaTensor", "[", "3", "]"}], "//", "Normal"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.57926870710017*^9, 3.5792687133005247`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], "+", 
      FractionBox["\[CapitalLambda]", "4"]}], ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["\[CapitalLambda]", "4"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.5792689916134434`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The original operator", "Subtitle",
 CellChangeTimes->{{3.5792687236591177`*^9, 3.579268724907189*^9}, {
   3.5792691652563753`*^9, 3.5792691660564213`*^9}, 3.5792697002529755`*^9}],

Cell[TextData[{
 "NonCommutativeMultiply ** is used to prevent ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " from reordering expressions."
}], "Text",
 CellChangeTimes->{{3.579269175903984*^9, 3.5792692069277587`*^9}, 
   3.5792697002529755`*^9}],

Cell["\<\
Preferably this should be done on tensor form instead of explicit sums, but I \
did not figure out how to get NonCommutativeMultiply into the tensor products.\
\>", "Text",
 CellChangeTimes->{{3.579268759747182*^9, 3.5792688143463044`*^9}, 
   3.5792697002529755`*^9}],

Cell[TextData[{
 "Here invPe is the inverse Peclet number. stEff is the \
\[OpenCurlyDoubleQuote]effective stokes\[CloseCurlyDoubleQuote] stEff = St / ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Alpha]", "y"], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Text",
 CellChangeTimes->{{3.579268822714783*^9, 3.5792688611879835`*^9}, 
   3.5792697002529755`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"operator", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "invPe"}], " ", "Lsqr"}], "+", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"I", " ", 
        RowBox[{"bmat", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], 
        RowBox[{"\[Epsilon]", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "p", ",", "q"}], "]"}], "]"}], " ", 
        RowBox[{
         RowBox[{"n", "[", "p", "]"}], " ", "**", 
         RowBox[{"L", "[", "q", "]"}], " ", "**", " ", 
         RowBox[{"n", "[", "j", "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q", ",", "1", ",", "3"}], "}"}]}], "]"}], "-", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"I", " ", "\[CapitalLambda]", " ", 
        RowBox[{"smat", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "k"}], "]"}], "]"}], " ", 
        RowBox[{"\[Epsilon]", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "p", ",", "q"}], "]"}], "]"}], " ", 
        RowBox[{
         RowBox[{"n", "[", "p", "]"}], " ", "**", 
         RowBox[{"L", "[", "q", "]"}], " ", "**", 
         RowBox[{"n", "[", "i", "]"}], "**", " ", 
         RowBox[{"n", "[", "j", "]"}], "**", 
         RowBox[{"n", "[", "k", "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p", ",", "1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q", ",", "1", ",", "3"}], "}"}]}], "]"}], "+", 
     RowBox[{"stEff", " ", "\[CapitalLambda]", " ", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "I"}], " ", 
           RowBox[{"bbmat", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], 
           RowBox[{"\[Epsilon]", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "p", ",", "q"}], "]"}], "]"}], " ", 
           RowBox[{
            RowBox[{"n", "[", "p", "]"}], " ", "**", 
            RowBox[{"L", "[", "q", "]"}], " ", "**", " ", 
            RowBox[{"n", "[", "j", "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"p", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", "1", ",", "3"}], "}"}]}], "]"}], "-", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "I"}], " ", 
           RowBox[{"bbmat", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "k"}], "]"}], "]"}], " ", 
           RowBox[{"\[Epsilon]", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "p", ",", "q"}], "]"}], "]"}], " ", 
           RowBox[{
            RowBox[{"n", "[", "p", "]"}], " ", "**", 
            RowBox[{"L", "[", "q", "]"}], " ", "**", 
            RowBox[{"n", "[", "i", "]"}], "**", " ", 
            RowBox[{"n", "[", "j", "]"}], "**", 
            RowBox[{"n", "[", "k", "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"p", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", "1", ",", "3"}], "}"}]}], "]"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[CapitalLambda]"}], " ", "I", " ", 
           RowBox[{"\[Epsilon]", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "p", ",", "q"}], "]"}], "]"}], " ", 
           RowBox[{"\[Epsilon]", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], 
           RowBox[{"smat", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "l"}], "]"}], "]"}], 
           RowBox[{"omega", "[", 
            RowBox[{"[", "s", "]"}], "]"}], 
           RowBox[{
            RowBox[{"n", "[", "p", "]"}], " ", "**", 
            RowBox[{"L", "[", "q", "]"}], " ", "**", " ", 
            RowBox[{"n", "[", "j", "]"}], "**", 
            RowBox[{"n", "[", "l", "]"}], "**", 
            RowBox[{"n", "[", "s", "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"p", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "1", ",", "3"}], "}"}]}], "]"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"I", " ", 
           RowBox[{"smat", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "k"}], "]"}], "]"}], " ", 
           RowBox[{"omat", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "s"}], "]"}], "]"}], 
           RowBox[{"\[Epsilon]", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "p", ",", "q"}], "]"}], "]"}], " ", 
           RowBox[{
            RowBox[{"n", "[", "p", "]"}], " ", "**", 
            RowBox[{"L", "[", "q", "]"}], " ", "**", 
            RowBox[{"n", "[", "s", "]"}], "**", " ", 
            RowBox[{"n", "[", "j", "]"}], "**", 
            RowBox[{"n", "[", "k", "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"p", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "1", ",", "3"}], "}"}]}], "]"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"2", "\[CapitalLambda]", " ", "I", " ", 
           RowBox[{"smat", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "k"}], "]"}], "]"}], " ", 
           RowBox[{"smat", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "s"}], "]"}], "]"}], 
           RowBox[{"\[Epsilon]", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "p", ",", "q"}], "]"}], "]"}], " ", 
           RowBox[{
            RowBox[{"n", "[", "p", "]"}], " ", "**", 
            RowBox[{"L", "[", "q", "]"}], " ", "**", 
            RowBox[{"n", "[", "s", "]"}], "**", " ", 
            RowBox[{"n", "[", "j", "]"}], "**", 
            RowBox[{"n", "[", "k", "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"p", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "1", ",", "3"}], "}"}]}], "]"}], "-", 
        "\[IndentingNewLine]", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"2", "\[CapitalLambda]", " ", "I", " ", 
           RowBox[{"smat", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "k"}], "]"}], "]"}], " ", 
           RowBox[{"smat", "[", 
            RowBox[{"[", 
             RowBox[{"s", ",", "o"}], "]"}], "]"}], 
           RowBox[{"\[Epsilon]", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "p", ",", "q"}], "]"}], "]"}], " ", 
           RowBox[{
            RowBox[{"n", "[", "p", "]"}], " ", "**", 
            RowBox[{"L", "[", "q", "]"}], " ", "**", 
            RowBox[{"n", "[", "i", "]"}], "**", " ", 
            RowBox[{"n", "[", "j", "]"}], "**", 
            RowBox[{"n", "[", "k", "]"}], "**", 
            RowBox[{"n", "[", "s", "]"}], "**", 
            RowBox[{"n", "[", "o", "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"p", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"o", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", ")"}]}]}], "//", "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.579268969938204*^9, 3.579268974626472*^9}, 
   3.5792697002549753`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"operator", " ", "=", " ", 
  RowBox[{"operator", "/.", 
   RowBox[{"stEff", "\[Rule]", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.57927014249227*^9, 3.5792701491616516`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", "invPe", " ", "Lsqr"}], "-", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[CapitalLambda]"}], ")"}], " ", 
     RowBox[{
      RowBox[{"n", "[", "1", "]"}], "**", 
      RowBox[{"L", "[", "3", "]"}], "**", 
      RowBox[{"n", "[", "1", "]"}]}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "\[CapitalLambda]"}], ")"}], " ", 
     RowBox[{
      RowBox[{"n", "[", "2", "]"}], "**", 
      RowBox[{"L", "[", "3", "]"}], "**", 
      RowBox[{"n", "[", "2", "]"}]}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[CapitalLambda]"}], ")"}], " ", 
     RowBox[{
      RowBox[{"n", "[", "3", "]"}], "**", 
      RowBox[{"L", "[", "1", "]"}], "**", 
      RowBox[{"n", "[", "1", "]"}]}]}], "-", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "\[CapitalLambda]"}], ")"}], " ", 
     RowBox[{
      RowBox[{"n", "[", "3", "]"}], "**", 
      RowBox[{"L", "[", "2", "]"}], "**", 
      RowBox[{"n", "[", "2", "]"}]}]}], "-", 
    RowBox[{"\[ImaginaryI]", " ", "\[CapitalLambda]", " ", 
     RowBox[{
      RowBox[{"n", "[", "1", "]"}], "**", 
      RowBox[{"L", "[", "2", "]"}], "**", 
      RowBox[{"n", "[", "3", "]"}], "**", 
      RowBox[{"n", "[", "1", "]"}], "**", 
      RowBox[{"n", "[", "2", "]"}]}]}], "-", 
    RowBox[{"\[ImaginaryI]", " ", "\[CapitalLambda]", " ", 
     RowBox[{
      RowBox[{"n", "[", "1", "]"}], "**", 
      RowBox[{"L", "[", "2", "]"}], "**", 
      RowBox[{"n", "[", "3", "]"}], "**", 
      RowBox[{"n", "[", "2", "]"}], "**", 
      RowBox[{"n", "[", "1", "]"}]}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", "\[CapitalLambda]", " ", 
     RowBox[{
      RowBox[{"n", "[", "1", "]"}], "**", 
      RowBox[{"L", "[", "3", "]"}], "**", 
      RowBox[{"n", "[", "2", "]"}], "**", 
      RowBox[{"n", "[", "1", "]"}], "**", 
      RowBox[{"n", "[", "2", "]"}]}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", "\[CapitalLambda]", " ", 
     RowBox[{
      RowBox[{"n", "[", "1", "]"}], "**", 
      RowBox[{"L", "[", "3", "]"}], "**", 
      RowBox[{"n", "[", "2", "]"}], "**", 
      RowBox[{"n", "[", "2", "]"}], "**", 
      RowBox[{"n", "[", "1", "]"}]}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", "\[CapitalLambda]", " ", 
     RowBox[{
      RowBox[{"n", "[", "2", "]"}], "**", 
      RowBox[{"L", "[", "1", "]"}], "**", 
      RowBox[{"n", "[", "3", "]"}], "**", 
      RowBox[{"n", "[", "1", "]"}], "**", 
      RowBox[{"n", "[", "2", "]"}]}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", "\[CapitalLambda]", " ", 
     RowBox[{
      RowBox[{"n", "[", "2", "]"}], "**", 
      RowBox[{"L", "[", "1", "]"}], "**", 
      RowBox[{"n", "[", "3", "]"}], "**", 
      RowBox[{"n", "[", "2", "]"}], "**", 
      RowBox[{"n", "[", "1", "]"}]}]}], "-", 
    RowBox[{"\[ImaginaryI]", " ", "\[CapitalLambda]", " ", 
     RowBox[{
      RowBox[{"n", "[", "2", "]"}], "**", 
      RowBox[{"L", "[", "3", "]"}], "**", 
      RowBox[{"n", "[", "1", "]"}], "**", 
      RowBox[{"n", "[", "1", "]"}], "**", 
      RowBox[{"n", "[", "2", "]"}]}]}], "-", 
    RowBox[{"\[ImaginaryI]", " ", "\[CapitalLambda]", " ", 
     RowBox[{
      RowBox[{"n", "[", "2", "]"}], "**", 
      RowBox[{"L", "[", "3", "]"}], "**", 
      RowBox[{"n", "[", "1", "]"}], "**", 
      RowBox[{"n", "[", "2", "]"}], "**", 
      RowBox[{"n", "[", "1", "]"}]}]}], "-", 
    RowBox[{"\[ImaginaryI]", " ", "\[CapitalLambda]", " ", 
     RowBox[{
      RowBox[{"n", "[", "3", "]"}], "**", 
      RowBox[{"L", "[", "1", "]"}], "**", 
      RowBox[{"n", "[", "2", "]"}], "**", 
      RowBox[{"n", "[", "1", "]"}], "**", 
      RowBox[{"n", "[", "2", "]"}]}]}], "-", 
    RowBox[{"\[ImaginaryI]", " ", "\[CapitalLambda]", " ", 
     RowBox[{
      RowBox[{"n", "[", "3", "]"}], "**", 
      RowBox[{"L", "[", "1", "]"}], "**", 
      RowBox[{"n", "[", "2", "]"}], "**", 
      RowBox[{"n", "[", "2", "]"}], "**", 
      RowBox[{"n", "[", "1", "]"}]}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", "\[CapitalLambda]", " ", 
     RowBox[{
      RowBox[{"n", "[", "3", "]"}], "**", 
      RowBox[{"L", "[", "2", "]"}], "**", 
      RowBox[{"n", "[", "1", "]"}], "**", 
      RowBox[{"n", "[", "1", "]"}], "**", 
      RowBox[{"n", "[", "2", "]"}]}]}], "+", 
    RowBox[{"\[ImaginaryI]", " ", "\[CapitalLambda]", " ", 
     RowBox[{
      RowBox[{"n", "[", "3", "]"}], "**", 
      RowBox[{"L", "[", "2", "]"}], "**", 
      RowBox[{"n", "[", "1", "]"}], "**", 
      RowBox[{"n", "[", "2", "]"}], "**", 
      RowBox[{"n", "[", "1", "]"}]}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.57927014984169*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Helper functions", "Section",
 CellChangeTimes->{{3.5792696900293903`*^9, 3.5792697002559757`*^9}}],

Cell["\<\
Find coefficient l,m of expr in a series expansion\
\>", "Text",
 CellChangeTimes->{3.579269361310589*^9, 3.5792697002559757`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Ylmcoeff", "[", 
    RowBox[{"expr_", ",", "l_", ",", "m_"}], "]"}], ":=", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"expr", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[Rule]", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Theta]", "]"}], 
            RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ",", 
          RowBox[{"y", "\[Rule]", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Theta]", "]"}], 
            RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ",", 
          RowBox[{"z", "\[Rule]", 
           RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "}"}]}], ")"}], " ", 
      RowBox[{"Conjugate", "[", 
       RowBox[{"SphericalHarmonicY", "[", 
        RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], "]"}], 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "0", ",", "Pi"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Phi]", ",", "0", ",", 
       RowBox[{"2", "Pi"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.579269354008171*^9, 3.5792693570403447`*^9}, 
   3.5792697002569757`*^9}],

Cell["\<\
Convert monomial, represented by a list of, n[i] to a series of the \
corresponding y[l,m]\
\>", "Text",
 CellChangeTimes->{{3.579269309287614*^9, 3.579269309942651*^9}, {
   3.5792693426465216`*^9, 3.579269412094494*^9}, 3.5792697002569757`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"toYlm", "[", "ns___", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"lmax", ",", "coeffs"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"lmax", " ", "=", " ", 
        RowBox[{"Length", "[", 
         RowBox[{"List", "[", "ns", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Total", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"ParallelTable", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Ylmcoeff", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Times", "[", "ns", "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"n", "[", "1", "]"}], "\[Rule]", "x"}], ",", 
                 RowBox[{
                  RowBox[{"n", "[", "2", "]"}], "\[Rule]", "y"}], ",", 
                 RowBox[{
                  RowBox[{"n", "[", "3", "]"}], "\[Rule]", "z"}]}], "}"}]}], 
              ",", "l", ",", "m"}], "]"}], 
            RowBox[{"y", "[", 
             RowBox[{"l", ",", "m"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", "0", ",", "lmax"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", 
             RowBox[{"-", "l"}], ",", "l"}], "}"}]}], "]"}], "]"}], "]"}]}]}],
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{3.5792694368559103`*^9, 3.5792697002569757`*^9}],

Cell["Example", "Text",
 CellChangeTimes->{{3.5792694386080103`*^9, 3.579269442886255*^9}, 
   3.5792697002579756`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"toYlm", "[", 
  RowBox[{
   RowBox[{"n", "[", "1", "]"}], ",", 
   RowBox[{"n", "[", "1", "]"}], ",", 
   RowBox[{"n", "[", "2", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.579269448254562*^9, 3.5792694488785973`*^9}, 
   3.5792697002579756`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "5"], " ", "\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox[
     RowBox[{"2", " ", "\[Pi]"}], "3"]], " ", 
   RowBox[{"y", "[", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}]}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "5"], " ", "\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox[
     RowBox[{"2", " ", "\[Pi]"}], "3"]], " ", 
   RowBox[{"y", "[", 
    RowBox[{"1", ",", "1"}], "]"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "35"]], " ", 
   RowBox[{"y", "[", 
    RowBox[{"3", ",", 
     RowBox[{"-", "3"}]}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "5"], " ", "\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "21"]], " ", 
   RowBox[{"y", "[", 
    RowBox[{"3", ",", 
     RowBox[{"-", "1"}]}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "5"], " ", "\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "21"]], " ", 
   RowBox[{"y", "[", 
    RowBox[{"3", ",", "1"}], "]"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "35"]], " ", 
   RowBox[{"y", "[", 
    RowBox[{"3", ",", "3"}], "]"}]}]}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{3.5792694594172*^9, 3.5792697002589755`*^9}]
}, Open  ]]
}, Open  ]],

Cell["\<\
Functions and rules that transform the operator\
\>", "Section",
 CellChangeTimes->{{3.5792691449932165`*^9, 3.5792691548557806`*^9}, 
   3.5792697002559757`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Operators are transformed in two steps.\
\>", "Subtitle",
 CellChangeTimes->{{3.5792696353422627`*^9, 3.5792696661410246`*^9}, {
  3.5792697194760747`*^9, 3.5792697279005566`*^9}, {3.5792698410990314`*^9, 
  3.579269841323044*^9}, {3.579269881955368*^9, 3.579269882323389*^9}}],

Cell["\<\
1. Reorder to \[OpenCurlyDoubleQuote]normal order\[CloseCurlyDoubleQuote], \
distribute, move all constants to left\
\>", "Text",
 CellChangeTimes->{{3.5792697299566746`*^9, 3.5792697680918555`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"operatorrules1", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"n", "[", "p_Integer", "]"}], "**", 
       RowBox[{"L", "[", "i_Integer", "]"}]}], "\[RuleDelayed]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"L", "[", "i", "]"}], "**", 
        RowBox[{"n", "[", "p", "]"}]}], "+", 
       RowBox[{"I", " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Signature", "[", 
            RowBox[{"{", 
             RowBox[{"p", ",", "i", ",", "j"}], "}"}], "]"}], 
           RowBox[{"n", "[", "j", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"n", "[", "i_Integer", "]"}], "**", 
       RowBox[{"n", "[", "j_Integer", "]"}]}], "\[RuleDelayed]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"n", "[", "j", "]"}], "**", 
        RowBox[{"n", "[", "i", "]"}]}], "/;", 
       RowBox[{"i", "<", "j"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x1_", "**", 
       RowBox[{"(", 
        RowBox[{"x2_", " ", "x3_"}], ")"}]}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"x2", " ", 
        RowBox[{"(", 
         RowBox[{"x1", "**", "x3"}], ")"}]}], "/;", 
       RowBox[{"notOperator", "[", "x2", "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x2_", " ", "x1_"}], ")"}], "**", " ", "x3_"}], 
      "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"x2", " ", 
        RowBox[{"(", 
         RowBox[{"x1", "**", "x3"}], ")"}]}], "/;", 
       RowBox[{"notOperator", "[", "x2", "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x1_Plus", "**", "x2_"}], "\[RuleDelayed]", 
      RowBox[{"Distribute", "[", 
       RowBox[{"x1", "**", "x2"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x1_", "**", "x2_Plus"}], "\[RuleDelayed]", 
      RowBox[{"Distribute", "[", 
       RowBox[{"x1", "**", "x2"}], "]"}]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input"],

Cell["\<\
2. Expand L[1] L[2] with L[p] L[m], and expand monomials of n[i] in y[l,m]\
\>", "Text",
 CellChangeTimes->{{3.5792697730521393`*^9, 3.579269804443935*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"operatorrules2", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"L", "[", "1", "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"1", "/", "2"}], 
        RowBox[{"L", "[", "p", "]"}]}], "+", 
       RowBox[{
        RowBox[{"1", "/", "2"}], " ", 
        RowBox[{"L", "[", "m", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"L", "[", "2", "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "I"}], "/", "2"}], " ", 
        RowBox[{"L", "[", "p", "]"}]}], "+", 
       RowBox[{
        RowBox[{"I", "/", "2"}], " ", 
        RowBox[{"L", "[", "m", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NonCommutativeMultiply", "[", 
       RowBox[{"ns", ":", 
        RowBox[{"Repeated", "[", 
         RowBox[{"n", "[", "_Integer", "]"}], "]"}]}], "]"}], 
      "\[RuleDelayed]", 
      RowBox[{"toYlm", "[", "ns", "]"}]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Then operators are evaluated in three steps", \
"Subtitle"]], "Subsubtitle",
 CellChangeTimes->{{3.579269894491085*^9, 3.579269905186697*^9}}],

Cell["\<\
3. Replace action of y[l,m] with the correct clebsch gordan sequence \
(placeholder)\
\>", "Text",
 CellChangeTimes->{{3.579269850611575*^9, 3.5792698682835865`*^9}, {
  3.5792699704424295`*^9, 3.5792699723385377`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"operatorrules3", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"l1_Integer", ",", "m1_Integer"}], "]"}], "**", 
      RowBox[{"y", "[", 
       RowBox[{"l", ",", "m"}], "]"}]}], "\[RuleDelayed]", " ", 
     RowBox[{"Total", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"cgcoeff", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"l1", ",", "m1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l", ",", "m"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"l", "+", "dl"}], ",", 
             RowBox[{"m", "+", "m1"}]}], "}"}]}], "]"}], " ", 
         RowBox[{"y", "[", 
          RowBox[{
           RowBox[{"l", "+", "dl"}], ",", 
           RowBox[{"m", "+", "m1"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"dl", ",", 
          RowBox[{"-", 
           RowBox[{"Abs", "[", "l1", "]"}]}], ",", 
          RowBox[{"Abs", "[", "l1", "]"}]}], "}"}]}], "]"}], "]"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input"],

Cell["\<\
4. Replace action of L-operators with their respective eigenvalue \
(placeholders)\
\>", "Text",
 CellChangeTimes->{{3.5792699506993*^9, 3.579269967674271*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"operatorrules4", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"L", "[", "m", "]"}], "**", 
       RowBox[{"y", "[", 
        RowBox[{"l_", ",", "m_"}], "]"}]}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"lm", "[", 
        RowBox[{"l", ",", "m"}], "]"}], " ", 
       RowBox[{"y", "[", 
        RowBox[{"l", ",", 
         RowBox[{"m", "-", "1"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"L", "[", "p", "]"}], "**", 
       RowBox[{"y", "[", 
        RowBox[{"l_", ",", "m_"}], "]"}]}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"lp", "[", 
        RowBox[{"l", ",", "m"}], "]"}], " ", 
       RowBox[{"y", "[", 
        RowBox[{"l", ",", 
         RowBox[{"m", "+", "1"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Lsqr", "**", 
       RowBox[{"y", "[", 
        RowBox[{"l_", ",", "m_"}], "]"}]}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"lsqr", "[", 
        RowBox[{"l", ",", "m"}], "]"}], " ", 
       RowBox[{"y", "[", 
        RowBox[{"l", ",", "m"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"L", "[", "3", "]"}], "**", 
       RowBox[{"y", "[", 
        RowBox[{"l_", ",", "m_"}], "]"}]}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"l3", "[", 
        RowBox[{"l", ",", "m"}], "]"}], " ", 
       RowBox[{"y", "[", 
        RowBox[{"l", ",", "m"}], "]"}]}]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5792699833721685`*^9, 3.579269984596239*^9}}],

Cell["\<\
5. Replace all placeholders with their correct values (This is messy, thus \
saved for last)\
\>", "Text",
 CellChangeTimes->{{3.5792700597855396`*^9, 3.5792700829858665`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"operatorrules5", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"cgcoeff", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"l1_", ",", "m1_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"l2_", ",", "m2_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"l_", ",", "m_"}], "}"}]}], "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "l1"}], "+", "1"}], ")"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "l2"}], "+", "1"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"4", " ", "Pi", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "l"}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}], 
       RowBox[{"ClebschGordan", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"l1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l2", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", "0"}], "}"}]}], "]"}], 
       RowBox[{"ClebschGordan", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"l1", ",", "m1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l2", ",", "m2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", "m"}], "}"}]}], "]"}]}]}], " ", ",", 
     RowBox[{
      RowBox[{"lsqr", "[", 
       RowBox[{"l_", ",", "m_"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"l", "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"Abs", "[", "m", "]"}], "\[LessEqual]", "l"}]}], ",", 
        RowBox[{"l", 
         RowBox[{"(", 
          RowBox[{"l", "+", "1"}], ")"}]}], ",", "0"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"l3", "[", 
       RowBox[{"l_", ",", "m_"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"l", "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"Abs", "[", "m", "]"}], "\[LessEqual]", "l"}]}], ",", "m", 
        ",", "0"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lp", "[", 
       RowBox[{"l_", ",", "m_"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"l", "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{"m", "<", "l"}]}], ",", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"l", "-", "m"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"l", "+", "m", "+", "1"}], ")"}]}], "]"}], ",", "0"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lm", "[", 
       RowBox[{"l_", ",", "m_"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"l", "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{"m", ">", 
          RowBox[{"-", "l"}]}]}], ",", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"l", "+", "m"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"l", "-", "m", "+", "1"}], ")"}]}], "]"}], ",", "0"}], 
       "]"}]}]}], "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.579270045061697*^9, 3.5792700543092265`*^9}}],

Cell["\<\
Transform the operator, step by step\
\>", "Section",
 CellChangeTimes->{{3.579270101033899*^9, 3.579270107825287*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Step 1", "Subtitle",
 CellChangeTimes->{{3.579270119745969*^9, 3.5792701249612675`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expression1", "=", 
  RowBox[{"FixedPoint", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Expand", "[", 
      RowBox[{
       RowBox[{"Expand", "[", "#", "]"}], "//.", "operatorrules1"}], "]"}], 
     "&"}], "  ", ",", 
    RowBox[{"operator", "**", 
     RowBox[{"y", "[", 
      RowBox[{"l", ",", "m"}], "]"}]}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "invPe"}], " ", 
   RowBox[{"Lsqr", "**", 
    RowBox[{"y", "[", 
     RowBox[{"l", ",", "m"}], "]"}]}]}], "-", 
  RowBox[{"2", " ", "\[CapitalLambda]", " ", 
   RowBox[{
    RowBox[{"n", "[", "2", "]"}], "**", 
    RowBox[{"n", "[", "1", "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"l", ",", "m"}], "]"}]}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   RowBox[{
    RowBox[{"L", "[", "1", "]"}], "**", 
    RowBox[{"n", "[", "3", "]"}], "**", 
    RowBox[{"n", "[", "1", "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"l", ",", "m"}], "]"}]}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "\[CapitalLambda]", " ", 
   RowBox[{
    RowBox[{"L", "[", "1", "]"}], "**", 
    RowBox[{"n", "[", "3", "]"}], "**", 
    RowBox[{"n", "[", "1", "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"l", ",", "m"}], "]"}]}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   RowBox[{
    RowBox[{"L", "[", "2", "]"}], "**", 
    RowBox[{"n", "[", "3", "]"}], "**", 
    RowBox[{"n", "[", "2", "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"l", ",", "m"}], "]"}]}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "\[CapitalLambda]", " ", 
   RowBox[{
    RowBox[{"L", "[", "2", "]"}], "**", 
    RowBox[{"n", "[", "3", "]"}], "**", 
    RowBox[{"n", "[", "2", "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"l", ",", "m"}], "]"}]}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   RowBox[{
    RowBox[{"L", "[", "3", "]"}], "**", 
    RowBox[{"n", "[", "1", "]"}], "**", 
    RowBox[{"n", "[", "1", "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"l", ",", "m"}], "]"}]}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "\[CapitalLambda]", " ", 
   RowBox[{
    RowBox[{"L", "[", "3", "]"}], "**", 
    RowBox[{"n", "[", "1", "]"}], "**", 
    RowBox[{"n", "[", "1", "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"l", ",", "m"}], "]"}]}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
   RowBox[{
    RowBox[{"L", "[", "3", "]"}], "**", 
    RowBox[{"n", "[", "2", "]"}], "**", 
    RowBox[{"n", "[", "2", "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"l", ",", "m"}], "]"}]}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "\[CapitalLambda]", " ", 
   RowBox[{
    RowBox[{"L", "[", "3", "]"}], "**", 
    RowBox[{"n", "[", "2", "]"}], "**", 
    RowBox[{"n", "[", "2", "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"l", ",", "m"}], "]"}]}]}], "+", 
  RowBox[{"2", " ", "\[CapitalLambda]", " ", 
   RowBox[{
    RowBox[{"n", "[", "2", "]"}], "**", 
    RowBox[{"n", "[", "1", "]"}], "**", 
    RowBox[{"n", "[", "1", "]"}], "**", 
    RowBox[{"n", "[", "1", "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"l", ",", "m"}], "]"}]}]}], "+", 
  RowBox[{"2", " ", "\[CapitalLambda]", " ", 
   RowBox[{
    RowBox[{"n", "[", "2", "]"}], "**", 
    RowBox[{"n", "[", "2", "]"}], "**", 
    RowBox[{"n", "[", "2", "]"}], "**", 
    RowBox[{"n", "[", "1", "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"l", ",", "m"}], "]"}]}]}], "+", 
  RowBox[{"2", " ", "\[CapitalLambda]", " ", 
   RowBox[{
    RowBox[{"n", "[", "3", "]"}], "**", 
    RowBox[{"n", "[", "3", "]"}], "**", 
    RowBox[{"n", "[", "2", "]"}], "**", 
    RowBox[{"n", "[", "1", "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"l", ",", "m"}], "]"}]}]}]}]], "Output",
 CellChangeTimes->{{3.5792701278524327`*^9, 3.5792701563070602`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Step 2, note also the first set of rules is used for distribution and moving \
of non-operator coefficients\
\>", "Subtitle",
 CellChangeTimes->{{3.5792701606613092`*^9, 3.579270206752946*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expression2", "=", 
  RowBox[{
   RowBox[{"FixedPoint", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Expand", "[", 
       RowBox[{
        RowBox[{"Expand", "[", "#", "]"}], "/.", 
        RowBox[{"Join", "[", 
         RowBox[{"operatorrules1", ",", "operatorrules2"}], "]"}]}], "]"}], 
      "&"}], "  ", ",", "expression1"}], "]"}], "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"c1_", " ", "x1_NonCommutativeMultiply"}], "+", 
      RowBox[{"c2_", " ", "x1_NonCommutativeMultiply"}]}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"c1", "+", "c2"}], ")"}], "x1"}]}], "}"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "invPe"}], " ", 
   RowBox[{"Lsqr", "**", 
    RowBox[{"y", "[", 
     RowBox[{"l", ",", "m"}], "]"}]}]}], "+", 
  RowBox[{
   FractionBox["2", "3"], " ", "\[ImaginaryI]", " ", 
   SqrtBox["\[Pi]"], " ", 
   RowBox[{
    RowBox[{"L", "[", "3", "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"0", ",", "0"}], "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"l", ",", "m"}], "]"}]}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox[
     RowBox[{"2", " ", "\[Pi]"}], "15"]], " ", "\[CapitalLambda]", " ", 
   RowBox[{
    RowBox[{"L", "[", "3", "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"2", ",", 
      RowBox[{"-", "2"}]}], "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"l", ",", "m"}], "]"}]}]}], "-", 
  RowBox[{
   FractionBox["2", "3"], " ", "\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "5"]], " ", 
   RowBox[{
    RowBox[{"L", "[", "3", "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"2", ",", "0"}], "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"l", ",", "m"}], "]"}]}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox[
     RowBox[{"2", " ", "\[Pi]"}], "15"]], " ", "\[CapitalLambda]", " ", 
   RowBox[{
    RowBox[{"L", "[", "3", "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"2", ",", "2"}], "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"l", ",", "m"}], "]"}]}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "30"]], " ", "\[CapitalLambda]", " ", 
   RowBox[{
    RowBox[{"L", "[", "m", "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"2", ",", 
      RowBox[{"-", "1"}]}], "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"l", ",", "m"}], "]"}]}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "30"]], " ", 
   RowBox[{
    RowBox[{"L", "[", "m", "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"l", ",", "m"}], "]"}]}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "30"]], " ", 
   RowBox[{
    RowBox[{"L", "[", "p", "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"2", ",", 
      RowBox[{"-", "1"}]}], "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"l", ",", "m"}], "]"}]}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "30"]], " ", "\[CapitalLambda]", " ", 
   RowBox[{
    RowBox[{"L", "[", "p", "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "**", 
    RowBox[{"y", "[", 
     RowBox[{"l", ",", "m"}], "]"}]}]}]}]], "Output",
 CellChangeTimes->{3.579270225820036*^9, 3.5792704365880914`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Evaluate the operators\[CloseCurlyQuote] actions\
\>", "Section",
 CellChangeTimes->{{3.579270266681373*^9, 3.579270267392414*^9}, {
  3.579270315184148*^9, 3.5792703233196125`*^9}}],

Cell["\<\
After using all evaluation rules, we have an expression which is 
J|l,m> = \[Sum]matrixelement[l,m,\[CapitalDelta]l,\[CapitalDelta]m] y[l+\
\[CapitalDelta]l, m+\[CapitalDelta]m], with matrixelement[] the actual matrix \
elements we seek\
\>", "Text",
 CellChangeTimes->{{3.5792707880451937`*^9, 3.579270942404022*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"expression3", "=", 
   RowBox[{"expression2", "/.", "operatorrules3"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"expression4", " ", "=", 
  RowBox[{"FixedPoint", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Expand", "[", 
      RowBox[{
       RowBox[{"Expand", "[", "#", "]"}], "/.", 
       RowBox[{"Join", "[", 
        RowBox[{"operatorrules1", ",", "operatorrules4"}], "]"}]}], "]"}], 
     "&"}], "  ", ",", "expression3"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.579270271297637*^9, {3.5792703871452637`*^9, 3.5792704095935473`*^9}, {
   3.5792705110003476`*^9, 3.579270546287366*^9}, {3.579270680552045*^9, 
   3.5792706808540626`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "\[ImaginaryI]"}], " ", 
   SqrtBox[
    FractionBox[
     RowBox[{"2", " ", "\[Pi]"}], "15"]], " ", "\[CapitalLambda]", " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], "+", "l"}], ",", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"l3", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], "+", "l"}], ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], "+", "l"}], ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "m"}]}], "]"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "30"]], " ", "\[CapitalLambda]", " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], "+", "l"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"lm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], "+", "l"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], "+", "l"}], ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "m"}]}], "]"}]}], "-", 
  RowBox[{
   FractionBox["2", "3"], " ", "\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "5"]], " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], "+", "l"}], ",", "m"}], "}"}]}], "]"}], " ", 
   RowBox[{"l3", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], "+", "l"}], ",", "m"}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], "+", "l"}], ",", "m"}], "]"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "30"]], " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], "+", "l"}], ",", 
       RowBox[{"1", "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"lm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], "+", "l"}], ",", 
     RowBox[{"1", "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], "+", "l"}], ",", "m"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "30"]], " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], "+", "l"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"lp", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], "+", "l"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], "+", "l"}], ",", "m"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox[
     RowBox[{"2", " ", "\[Pi]"}], "15"]], " ", "\[CapitalLambda]", " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], "+", "l"}], ",", 
       RowBox[{"2", "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"l3", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], "+", "l"}], ",", 
     RowBox[{"2", "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], "+", "l"}], ",", 
     RowBox[{"2", "+", "m"}]}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "30"]], " ", "\[CapitalLambda]", " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], "+", "l"}], ",", 
       RowBox[{"1", "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"lp", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], "+", "l"}], ",", 
     RowBox[{"1", "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], "+", "l"}], ",", 
     RowBox[{"2", "+", "m"}]}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox[
     RowBox[{"2", " ", "\[Pi]"}], "15"]], " ", "\[CapitalLambda]", " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", "l"}], ",", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"l3", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", "l"}], ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", "l"}], ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "m"}]}], "]"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "30"]], " ", "\[CapitalLambda]", " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", "l"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"lm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", "l"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", "l"}], ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "m"}]}], "]"}]}], "-", 
  RowBox[{
   FractionBox["2", "3"], " ", "\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "5"]], " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", "l"}], ",", "m"}], "}"}]}], "]"}], " ", 
   RowBox[{"l3", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", "l"}], ",", "m"}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", "l"}], ",", "m"}], "]"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "30"]], " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", "l"}], ",", 
       RowBox[{"1", "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"lm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", "l"}], ",", 
     RowBox[{"1", "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", "l"}], ",", "m"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "30"]], " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", "l"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"lp", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", "l"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", "l"}], ",", "m"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox[
     RowBox[{"2", " ", "\[Pi]"}], "15"]], " ", "\[CapitalLambda]", " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", "l"}], ",", 
       RowBox[{"2", "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"l3", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", "l"}], ",", 
     RowBox[{"2", "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", "l"}], ",", 
     RowBox[{"2", "+", "m"}]}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "30"]], " ", "\[CapitalLambda]", " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "+", "l"}], ",", 
       RowBox[{"1", "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"lp", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", "l"}], ",", 
     RowBox[{"1", "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", "l"}], ",", 
     RowBox[{"2", "+", "m"}]}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox[
     RowBox[{"2", " ", "\[Pi]"}], "15"]], " ", "\[CapitalLambda]", " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"l3", "[", 
    RowBox[{"l", ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{"l", ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "m"}]}], "]"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "30"]], " ", "\[CapitalLambda]", " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"lm", "[", 
    RowBox[{"l", ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{"l", ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "m"}]}], "]"}]}], "+", 
  RowBox[{
   FractionBox["2", "3"], " ", "\[ImaginaryI]", " ", 
   SqrtBox["\[Pi]"], " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}]}], "]"}], " ", 
   RowBox[{"l3", "[", 
    RowBox[{"l", ",", "m"}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{"l", ",", "m"}], "]"}]}], "-", 
  RowBox[{
   FractionBox["2", "3"], " ", "\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "5"]], " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}]}], "]"}], " ", 
   RowBox[{"l3", "[", 
    RowBox[{"l", ",", "m"}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{"l", ",", "m"}], "]"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "30"]], " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", 
       RowBox[{"1", "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"lm", "[", 
    RowBox[{"l", ",", 
     RowBox[{"1", "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{"l", ",", "m"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "30"]], " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"lp", "[", 
    RowBox[{"l", ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{"l", ",", "m"}], "]"}]}], "-", 
  RowBox[{"invPe", " ", 
   RowBox[{"lsqr", "[", 
    RowBox[{"l", ",", "m"}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{"l", ",", "m"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox[
     RowBox[{"2", " ", "\[Pi]"}], "15"]], " ", "\[CapitalLambda]", " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", 
       RowBox[{"2", "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"l3", "[", 
    RowBox[{"l", ",", 
     RowBox[{"2", "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{"l", ",", 
     RowBox[{"2", "+", "m"}]}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "30"]], " ", "\[CapitalLambda]", " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", 
       RowBox[{"1", "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"lp", "[", 
    RowBox[{"l", ",", 
     RowBox[{"1", "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{"l", ",", 
     RowBox[{"2", "+", "m"}]}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox[
     RowBox[{"2", " ", "\[Pi]"}], "15"]], " ", "\[CapitalLambda]", " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "+", "l"}], ",", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"l3", "[", 
    RowBox[{
     RowBox[{"1", "+", "l"}], ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{"1", "+", "l"}], ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "m"}]}], "]"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "30"]], " ", "\[CapitalLambda]", " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "+", "l"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"lm", "[", 
    RowBox[{
     RowBox[{"1", "+", "l"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{"1", "+", "l"}], ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "m"}]}], "]"}]}], "-", 
  RowBox[{
   FractionBox["2", "3"], " ", "\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "5"]], " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "+", "l"}], ",", "m"}], "}"}]}], "]"}], " ", 
   RowBox[{"l3", "[", 
    RowBox[{
     RowBox[{"1", "+", "l"}], ",", "m"}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{"1", "+", "l"}], ",", "m"}], "]"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "30"]], " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "+", "l"}], ",", 
       RowBox[{"1", "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"lm", "[", 
    RowBox[{
     RowBox[{"1", "+", "l"}], ",", 
     RowBox[{"1", "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{"1", "+", "l"}], ",", "m"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "30"]], " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "+", "l"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"lp", "[", 
    RowBox[{
     RowBox[{"1", "+", "l"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{"1", "+", "l"}], ",", "m"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox[
     RowBox[{"2", " ", "\[Pi]"}], "15"]], " ", "\[CapitalLambda]", " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "+", "l"}], ",", 
       RowBox[{"2", "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"l3", "[", 
    RowBox[{
     RowBox[{"1", "+", "l"}], ",", 
     RowBox[{"2", "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{"1", "+", "l"}], ",", 
     RowBox[{"2", "+", "m"}]}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "30"]], " ", "\[CapitalLambda]", " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "+", "l"}], ",", 
       RowBox[{"1", "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"lp", "[", 
    RowBox[{
     RowBox[{"1", "+", "l"}], ",", 
     RowBox[{"1", "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{"1", "+", "l"}], ",", 
     RowBox[{"2", "+", "m"}]}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox[
     RowBox[{"2", " ", "\[Pi]"}], "15"]], " ", "\[CapitalLambda]", " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", "+", "l"}], ",", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"l3", "[", 
    RowBox[{
     RowBox[{"2", "+", "l"}], ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{"2", "+", "l"}], ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "m"}]}], "]"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "30"]], " ", "\[CapitalLambda]", " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", "+", "l"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"lm", "[", 
    RowBox[{
     RowBox[{"2", "+", "l"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{"2", "+", "l"}], ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "m"}]}], "]"}]}], "-", 
  RowBox[{
   FractionBox["2", "3"], " ", "\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "5"]], " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", "+", "l"}], ",", "m"}], "}"}]}], "]"}], " ", 
   RowBox[{"l3", "[", 
    RowBox[{
     RowBox[{"2", "+", "l"}], ",", "m"}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{"2", "+", "l"}], ",", "m"}], "]"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "30"]], " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", "+", "l"}], ",", 
       RowBox[{"1", "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"lm", "[", 
    RowBox[{
     RowBox[{"2", "+", "l"}], ",", 
     RowBox[{"1", "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{"2", "+", "l"}], ",", "m"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "30"]], " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", "+", "l"}], ",", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"lp", "[", 
    RowBox[{
     RowBox[{"2", "+", "l"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{"2", "+", "l"}], ",", "m"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox[
     RowBox[{"2", " ", "\[Pi]"}], "15"]], " ", "\[CapitalLambda]", " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", "+", "l"}], ",", 
       RowBox[{"2", "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"l3", "[", 
    RowBox[{
     RowBox[{"2", "+", "l"}], ",", 
     RowBox[{"2", "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{"2", "+", "l"}], ",", 
     RowBox[{"2", "+", "m"}]}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox[
    FractionBox["\[Pi]", "30"]], " ", "\[CapitalLambda]", " ", 
   RowBox[{"cgcoeff", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "m"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", "+", "l"}], ",", 
       RowBox[{"1", "+", "m"}]}], "}"}]}], "]"}], " ", 
   RowBox[{"lp", "[", 
    RowBox[{
     RowBox[{"2", "+", "l"}], ",", 
     RowBox[{"1", "+", "m"}]}], "]"}], " ", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{"2", "+", "l"}], ",", 
     RowBox[{"2", "+", "m"}]}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.579270419354106*^9, 3.5792704367170987`*^9}, {
   3.579270513545493*^9, 3.5792705276943026`*^9}, 3.5792706813160887`*^9}]
}, Open  ]]
}, Open  ]],

Cell["Sort out which <p,q| survive", "Section",
 CellChangeTimes->{{3.5792705851185865`*^9, 3.5792706297821417`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Make a list of all <p,q| , called targets, and a list \
of all the \[CapitalDelta]l, \[CapitalDelta]m such that p = l + \
\[CapitalDelta]l, q = m + \[CapitalDelta]m.", "Text"]], "Subtitle",
 CellChangeTimes->{{3.5792706402537403`*^9, 3.579270651573388*^9}, {
  3.5792706940378165`*^9, 3.5792707237575164`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"result", " ", "=", " ", "expression4"}], ";"}]], "Input",
 CellChangeTimes->{{3.5792709809092245`*^9, 3.579270983612379*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"targets", "=", 
  RowBox[{
   RowBox[{"Cases", "[", 
    RowBox[{"result", ",", 
     RowBox[{
      RowBox[{"_", " ", 
       RowBox[{"y", "[", 
        RowBox[{"l_", ",", "m_"}], "]"}]}], "\[RuleDelayed]", 
      RowBox[{"y", "[", 
       RowBox[{"l", ",", "m"}], "]"}]}]}], "]"}], "//", 
   "DeleteDuplicates"}]}], "\[IndentingNewLine]", 
 RowBox[{"deltalm", "=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "/.", 
      RowBox[{
       RowBox[{"y", "[", 
        RowBox[{"li_", ",", "mi_"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"li", "-", "l"}], ",", 
         RowBox[{"mi", "-", "m"}]}], "}"}]}]}], "&"}], ",", " ", "targets"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.579270658358776*^9, 3.579270660934923*^9}, {
  3.5792707369422703`*^9, 3.57927073727829*^9}, {3.5792709511565228`*^9, 
  3.579270952172581*^9}, {3.5792709867245574`*^9, 3.5792709872695885`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], "+", "l"}], ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "m"}]}], "]"}], ",", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], "+", "l"}], ",", "m"}], "]"}], ",", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], "+", "l"}], ",", 
     RowBox[{"2", "+", "m"}]}], "]"}], ",", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", "l"}], ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "m"}]}], "]"}], ",", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", "l"}], ",", "m"}], "]"}], ",", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "+", "l"}], ",", 
     RowBox[{"2", "+", "m"}]}], "]"}], ",", 
   RowBox[{"y", "[", 
    RowBox[{"l", ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "m"}]}], "]"}], ",", 
   RowBox[{"y", "[", 
    RowBox[{"l", ",", "m"}], "]"}], ",", 
   RowBox[{"y", "[", 
    RowBox[{"l", ",", 
     RowBox[{"2", "+", "m"}]}], "]"}], ",", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{"1", "+", "l"}], ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "m"}]}], "]"}], ",", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{"1", "+", "l"}], ",", "m"}], "]"}], ",", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{"1", "+", "l"}], ",", 
     RowBox[{"2", "+", "m"}]}], "]"}], ",", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{"2", "+", "l"}], ",", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "m"}]}], "]"}], ",", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{"2", "+", "l"}], ",", "m"}], "]"}], ",", 
   RowBox[{"y", "[", 
    RowBox[{
     RowBox[{"2", "+", "l"}], ",", 
     RowBox[{"2", "+", "m"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.579270655054587*^9, 3.5792706861023626`*^9}, 
   3.579270738645368*^9, 3.5792709893547077`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", 
     RowBox[{"-", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     RowBox[{"-", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.579270655054587*^9, 3.5792706861023626`*^9}, 
   3.579270738645368*^9, 3.579270989356708*^9}]
}, Open  ]],

Cell["\<\
Find all the coefficients to the targets, these are the matrix elements. \
However, some may be identically 0 (non-trivially) upon inserting the actual \
eigenvalues. We call these the raw matrix elements, that we should simplify.\
\>", "Text",
 CellChangeTimes->{{3.5792709762759595`*^9, 3.5792710530033484`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"matrixelementsraw", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Coefficient", "[", 
       RowBox[{"result", ",", "#"}], "]"}], "&"}], ",", "targets"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5792709598920226`*^9, 3.57927097226073*^9}}],

Cell["\<\
Then, we just simplify those with \[CapitalDelta]m>=0 since the coefficient \
with negative \[CapitalDelta]m will be the (-1)^\[CapitalDelta]m conjugate\
\>", "Text",
 CellChangeTimes->{{3.5792716842064514`*^9, 3.5792717344463243`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"indicesToSimplify", "=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{"k", ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", 
        RowBox[{"Length", "[", "deltalm", "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"deltalm", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "\[GreaterEqual]", "0"}], "&"}]}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2", ",", "3", ",", "5", ",", "6", ",", "8", ",", "9", ",", "11", ",", "12",
    ",", "14", ",", "15"}], "}"}]], "Output",
 CellChangeTimes->{3.57927132542693*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"simplifycoeff", "[", "k_", "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"deltalm", "[", 
      RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"matrixelementsraw", "[", 
         RowBox[{"[", "k", "]"}], "]"}], "/.", "operatorrules5"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"l", "\[Element]", "Integers"}], ",", 
         RowBox[{"l", "\[GreaterEqual]", "0"}], ",", 
         RowBox[{"m", "\[Element]", "Integers"}], ",", 
         RowBox[{
          RowBox[{"-", "l"}], "\[LessEqual]", "m", "\[LessEqual]", "l"}], ",", 
         RowBox[{
          RowBox[{"-", "1"}], "<=", "\[CapitalLambda]", "\[LessEqual]", "1"}],
          ",", 
         RowBox[{"stEff", ">", "0"}]}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5792710954677773`*^9, 3.579271145267626*^9}, {
  3.5792714282668123`*^9, 3.57927142857883*^9}}],

Cell["\<\
This simplification may take a long time for a complicated operator, then use \
just Simplify instead\
\>", "Text",
 CellChangeTimes->{{3.5792717510702753`*^9, 3.579271767286203*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"matrixelementsrawsimplified", "=", 
   RowBox[{"ParallelMap", "[", 
    RowBox[{"simplifycoeff", ",", "indicesToSimplify"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5792713433719563`*^9, 3.5792713671153145`*^9}, 
   3.5792713999871945`*^9, {3.5792715278565083`*^9, 3.579271529688613*^9}}],

Cell["\<\
Finally, assemble list of nonzero matrix elements on the form
{ {{\[CapitalDelta]l, \[CapitalDelta]m}, coeff1}, ...}\
\>", "Text",
 CellChangeTimes->{{3.579271775086649*^9, 3.579271808133539*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"matrixelements", " ", "=", " ", 
  RowBox[{"Select", "[", 
   RowBox[{"matrixelementsrawsimplified", ",", 
    RowBox[{
     RowBox[{"Not", "[", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "===", "0"}], "]"}], "&"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5792715372090435`*^9, 3.5792716369597487`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", "0"}], "}"}], ",", 
     TagBox[GridBox[{
        {"\[Piecewise]", GridBox[{
           {"0", 
            RowBox[{
             RowBox[{"l", "<", "2"}], "||", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"l", "\[GreaterEqual]", 
                  RowBox[{"2", "+", "m"}]}], "||", 
                 RowBox[{
                  RowBox[{"l", "+", "m"}], "\[LessEqual]", "1"}]}], ")"}], "&&", 
               RowBox[{"m", "\[GreaterEqual]", "0"}]}], ")"}], "||", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", "<", "0"}], "&&", 
               RowBox[{
                RowBox[{"l", "+", "m"}], "\[GreaterEqual]", "2"}]}], ")"}]}]},
           {
            RowBox[{
             FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", "m", " ", 
             SqrtBox[
              FractionBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "l", "-", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"l", "-", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "l", "+", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"l", "+", "m"}], ")"}]}], 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"2", " ", "l"}]}], ")"}], "2"], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "l"}], ")"}], "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", 
                  RowBox[{"2", " ", "l"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"2", " ", "l"}]}], ")"}]}]]]}], 
            RowBox[{
             RowBox[{"l", ">", 
              RowBox[{"1", "+", "m"}]}], "&&", 
             RowBox[{
              RowBox[{"l", "+", "m"}], ">", "1"}]}]},
           {
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", "l", "-", "m"}], ")"}], " ", 
              SqrtBox[
               FractionBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "l", "-", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"l", "-", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "l", "+", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"l", "+", "m"}], ")"}]}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "3"}], "+", 
                   RowBox[{"2", " ", "l"}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"2", " ", "l"}]}], ")"}]}]]]}], 
             RowBox[{
              RowBox[{"-", "4"}], "+", 
              RowBox[{"8", " ", "l"}]}]], 
            RowBox[{
             RowBox[{"l", "\[GreaterEqual]", "2"}], "&&", 
             RowBox[{
              RowBox[{"l", "+", "m"}], ">", "1"}]}]},
           {
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", "l", "+", "m"}], ")"}], " ", 
              SqrtBox[
               RowBox[{"-", 
                FractionBox[
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "l", "-", "m"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"l", "-", "m"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "l", "+", "m"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"l", "+", "m"}], ")"}]}], 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "3"}], "+", 
                    RowBox[{"2", " ", "l"}]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"2", " ", "l"}]}], ")"}]}]]}]]}], 
             RowBox[{
              RowBox[{"-", "4"}], "+", 
              RowBox[{"8", " ", "l"}]}]], 
            TagBox["True",
             "PiecewiseDefault",
             AutoDelete->True]}
          },
          AllowedDimensions->{2, Automatic},
          Editable->True,
          
          GridBoxAlignment->{
           "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{1.}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.84]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}},
          Selectable->True]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.35]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      "Piecewise",
      DeleteWithContents->True,
      Editable->False,
      SelectWithContents->True,
      Selectable->False]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
     TagBox[GridBox[{
        {"\[Piecewise]", GridBox[{
           {
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", "l"}], ")"}], " ", 
              SqrtBox[
               FractionBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "3"}], "+", "l", "-", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "2"}], "+", "l", "-", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "l", "-", "m"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"l", "-", "m"}], ")"}]}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "3"}], "+", 
                   RowBox[{"2", " ", "l"}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"2", " ", "l"}]}], ")"}]}]]], " ", 
              "\[CapitalLambda]"}], 
             RowBox[{
              RowBox[{"-", "4"}], "+", 
              RowBox[{"8", " ", "l"}]}]], 
            RowBox[{
             RowBox[{"l", "\[GreaterEqual]", "2"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"l", "\[GreaterEqual]", 
                RowBox[{"4", "+", "m"}]}], "||", 
               RowBox[{"m", "<", 
                RowBox[{"-", "2"}]}]}], ")"}]}]},
           {
            RowBox[{
             FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "l"}], ")"}], " ", 
             SqrtBox[
              FractionBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", "l", "-", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "l", "-", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "l", "-", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"l", "-", "m"}], ")"}], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"l", "+", "m"}], ")"}], "2"]}], 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"2", " ", "l"}]}], ")"}], "2"], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "l"}], ")"}], "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", 
                  RowBox[{"2", " ", "l"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"2", " ", "l"}]}], ")"}]}]]], " ", 
             "\[CapitalLambda]"}], 
            RowBox[{"l", ">", 
             RowBox[{"3", "+", "m"}]}]},
           {"0", 
            TagBox["True",
             "PiecewiseDefault",
             AutoDelete->True]}
          },
          AllowedDimensions->{2, Automatic},
          Editable->True,
          
          GridBoxAlignment->{
           "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{1.}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.84]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}},
          Selectable->True]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.35]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      "Piecewise",
      DeleteWithContents->True,
      Editable->False,
      SelectWithContents->True,
      Selectable->False]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     TagBox[GridBox[{
        {"\[Piecewise]", GridBox[{
           {
            RowBox[{
             RowBox[{
              RowBox[{"-", "invPe"}], " ", "l", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", "l"}], ")"}]}], "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "m"}], "3"]}], 
            RowBox[{"l", "<", "1"}]},
           {
            RowBox[{
             RowBox[{
              RowBox[{"-", "invPe"}], " ", "l", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", "l"}], ")"}]}], "+", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "m"}], "2"]}], 
            TagBox["True",
             "PiecewiseDefault",
             AutoDelete->True]}
          },
          AllowedDimensions->{2, Automatic},
          Editable->True,
          
          GridBoxAlignment->{
           "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{1.}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.84]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}},
          Selectable->True]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.35]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      "Piecewise",
      DeleteWithContents->True,
      Editable->False,
      SelectWithContents->True,
      Selectable->False]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "2"}], "}"}], ",", 
     TagBox[GridBox[{
        {"\[Piecewise]", GridBox[{
           {
            RowBox[{
             FractionBox["3", "4"], " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "l"}], ")"}], " ", 
             SqrtBox[
              FractionBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "l", "-", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"l", "-", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "l", "+", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"2", "+", "l", "+", "m"}], ")"}]}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", 
                  RowBox[{"l", " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"4", " ", "l", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", "l"}], ")"}]}]}], ")"}]}]}], ")"}], 
                "2"]]], " ", "\[CapitalLambda]"}], 
            RowBox[{
             RowBox[{"l", "\[GreaterEqual]", "1"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"l", "\[GreaterEqual]", 
                RowBox[{"2", "+", "m"}]}], "||", 
               RowBox[{"m", "<", 
                RowBox[{"-", "2"}]}]}], ")"}]}]},
           {
            RowBox[{
             RowBox[{"-", 
              FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "l"}], ")"}], " ", 
             SqrtBox[
              FractionBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "l", "-", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"l", "-", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "l", "+", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"2", "+", "l", "+", "m"}], ")"}]}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", 
                  RowBox[{"l", " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"4", " ", "l", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", "l"}], ")"}]}]}], ")"}]}]}], ")"}], 
                "2"]]], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"2", " ", "m"}]}], ")"}], " ", "\[CapitalLambda]"}], 
            RowBox[{"l", ">", 
             RowBox[{"1", "+", "m"}]}]},
           {"0", 
            TagBox["True",
             "PiecewiseDefault",
             AutoDelete->True]}
          },
          AllowedDimensions->{2, Automatic},
          Editable->True,
          
          GridBoxAlignment->{
           "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{1.}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.84]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}},
          Selectable->True]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
          "RowsIndexed" -> {}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
         "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.35]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      "Piecewise",
      DeleteWithContents->True,
      Editable->False,
      SelectWithContents->True,
      Selectable->False]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", "l"}], ")"}], " ", 
        SqrtBox[
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "l", "+", "m"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", "l", "+", "m"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", "l", "+", "m"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"4", "+", "l", "+", "m"}], ")"}]}], 
          RowBox[{"5", "+", 
           RowBox[{"12", " ", "l"}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["l", "2"]}]}]]], " ", "\[CapitalLambda]"}], 
       RowBox[{"12", "+", 
        RowBox[{"8", " ", "l"}]}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.579271639756909*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
Evaluator->"Sixth",
WindowSize->{820, 1097},
WindowMargins->{{276, Automatic}, {Automatic, 91}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (November 20, 2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 155, 3, 144, "Title"],
Cell[737, 27, 346, 8, 51, "Text"],
Cell[1086, 37, 271, 6, 68, "Text"],
Cell[1360, 45, 777, 23, 72, "Input"],
Cell[2140, 70, 149, 3, 79, "Section"],
Cell[CellGroupData[{
Cell[2314, 77, 128, 3, 49, "Subtitle"],
Cell[CellGroupData[{
Cell[2467, 84, 1639, 53, 152, "Input"],
Cell[4109, 139, 461, 15, 46, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[4619, 160, 187, 2, 49, "Subtitle"],
Cell[4809, 164, 255, 7, 30, "Text"],
Cell[5067, 173, 278, 5, 49, "Text"],
Cell[5348, 180, 375, 9, 30, "Text"],
Cell[5726, 191, 9643, 239, 412, "Input"],
Cell[CellGroupData[{
Cell[15394, 434, 198, 4, 31, "Input"],
Cell[15595, 440, 4798, 121, 108, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20430, 566, 105, 1, 79, "Section"],
Cell[20538, 569, 140, 3, 30, "Text"],
Cell[20681, 574, 1222, 32, 72, "Input"],
Cell[21906, 608, 256, 5, 30, "Text"],
Cell[22165, 615, 1543, 40, 172, "Input"],
Cell[23711, 657, 119, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[23855, 663, 274, 7, 31, "Input"],
Cell[24132, 672, 1285, 43, 106, "Output"]
}, Open  ]]
}, Open  ]],
Cell[25444, 719, 172, 4, 79, "Section"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25653, 728, 287, 5, 49, "Subtitle"],
Cell[25943, 735, 209, 4, 30, "Text"],
Cell[26155, 741, 2190, 62, 192, "Input"],
Cell[28348, 805, 166, 3, 30, "Text"],
Cell[28517, 810, 1058, 31, 112, "Input"],
Cell[CellGroupData[{
Cell[29600, 845, 166, 2, 37, "Subsubtitle"],
Cell[29769, 849, 229, 5, 30, "Text"],
Cell[30001, 856, 1147, 33, 112, "Input"],
Cell[31151, 891, 170, 4, 30, "Text"],
Cell[31324, 897, 1631, 47, 132, "Input"],
Cell[32958, 946, 186, 4, 30, "Text"],
Cell[33147, 952, 3399, 99, 192, "Input"],
Cell[36549, 1053, 129, 3, 79, "Section"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[36727, 1062, 94, 1, 49, "Subtitle"],
Cell[CellGroupData[{
Cell[36846, 1067, 359, 11, 52, "Input"],
Cell[37208, 1080, 3586, 101, 212, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40843, 1187, 203, 4, 77, "Subtitle"],
Cell[CellGroupData[{
Cell[41071, 1195, 662, 19, 92, "Input"],
Cell[41736, 1216, 2685, 85, 242, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44458, 1306, 192, 4, 79, "Section"],
Cell[44653, 1312, 328, 6, 49, "Text"],
Cell[CellGroupData[{
Cell[45006, 1322, 690, 18, 72, "Input"],
Cell[45699, 1342, 24205, 825, 1758, "Output"]
}, Open  ]]
}, Open  ]],
Cell[69931, 2171, 117, 1, 79, "Section"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70085, 2177, 334, 4, 38, "Subtitle"],
Cell[70422, 2183, 160, 3, 31, "Input"],
Cell[CellGroupData[{
Cell[70607, 2190, 967, 27, 52, "Input"],
Cell[71577, 2219, 1945, 67, 72, "Output"],
Cell[73525, 2288, 1285, 45, 52, "Output"]
}, Open  ]],
Cell[74825, 2336, 324, 5, 49, "Text"],
Cell[75152, 2343, 311, 9, 31, "Input"],
Cell[75466, 2354, 246, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[75737, 2362, 484, 15, 31, "Input"],
Cell[76224, 2379, 205, 5, 31, "Output"]
}, Open  ]],
Cell[76444, 2387, 1064, 26, 112, "Input"],
Cell[77511, 2415, 193, 4, 30, "Text"],
Cell[77707, 2421, 334, 7, 31, "Input"],
Cell[78044, 2430, 206, 4, 49, "Text"],
Cell[CellGroupData[{
Cell[78275, 2438, 373, 10, 31, "Input"],
Cell[78651, 2450, 18971, 511, 582, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
